function It(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var ri=0;function ms(r){return"__private_"+ri+++"_"+r}function si(r,e,t){const s=[];return r.forEach(i=>typeof i!="string"?s.push(i):e[Symbol.split](i).forEach((o,n,a)=>{o!==""&&s.push(o),n<a.length-1&&s.push(t)})),s}/**
 * Takes a string with placeholder variables like `%{smart_count} file selected`
 * and replaces it with values from options `{smart_count: 5}`
 *
 * @license https://github.com/airbnb/polyglot.js/blob/master/LICENSE
 * taken from https://github.com/airbnb/polyglot.js/blob/master/lib/polyglot.js#L299
 *
 * @param phrase that needs interpolation, with placeholders
 * @param options with values that will be used to replace placeholders
 */function Wr(r,e){const t=/\$/g,s="$$$$";let i=[r];if(e==null)return i;for(const o of Object.keys(e))if(o!=="_"){let n=e[o];typeof n=="string"&&(n=t[Symbol.replace](n,s)),i=si(i,new RegExp(`%\\{${o}\\}`,"g"),n)}return i}const ii=r=>{throw new Error(`missing string: ${r}`)};var it=ms("onMissingKey"),ot=ms("apply");class gs{constructor(e,t){let{onMissingKey:s=ii}=t===void 0?{}:t;Object.defineProperty(this,ot,{value:oi}),Object.defineProperty(this,it,{writable:!0,value:void 0}),this.locale={strings:{},pluralize(i){return i===1?0:1}},Array.isArray(e)?e.forEach(It(this,ot)[ot],this):It(this,ot)[ot](e),It(this,it)[it]=s}translate(e,t){return this.translateArray(e,t).join("")}translateArray(e,t){let s=this.locale.strings[e];if(s==null&&(It(this,it)[it](e),s=e),typeof s=="object"){if(t&&typeof t.smart_count<"u"){const o=this.locale.pluralize(t.smart_count);return Wr(s[o],t)}throw new Error("Attempted to use a string with plural forms, but no value was given for %{smart_count}")}if(typeof s!="string")throw new Error("string was not a string");return Wr(s,t)}}function oi(r){if(!(r!=null&&r.strings))return;const e=this.locale;Object.assign(this.locale,{strings:{...e.strings,...r.strings},pluralize:r.pluralize||e.pluralize})}var Bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tt(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var ni=function(){var e={},t=e._fns={};e.emit=function(n,a,l,c,d,u,h){var p=s(n);p.length&&i(n,p,[a,l,c,d,u,h])},e.on=function(n,a){t[n]||(t[n]=[]),t[n].push(a)},e.once=function(n,a){function l(){a.apply(this,arguments),e.off(n,l)}this.on(n,l)},e.off=function(n,a){var l=[];if(n&&a){var c=this._fns[n],d=0,u=c?c.length:0;for(d;d<u;d++)c[d]!==a&&l.push(c[d])}l.length?this._fns[n]=l:delete this._fns[n]};function s(o){var n=t[o]?t[o]:[],a=o.indexOf(":"),l=a===-1?[o]:[o.substring(0,a),o.substring(a+1)],c=Object.keys(t),d=0,u=c.length;for(d;d<u;d++){var h=c[d];if(h==="*"&&(n=n.concat(t[h])),l.length===2&&l[0]===h){n=n.concat(t[h]);break}}return n}function i(o,n,a){var l=0,c=n.length;for(l;l<c&&n[l];l++)n[l].event=o,n[l].apply(n[l],a)}return e};const ai=tt(ni);let li="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",ui=(r=21)=>{let e="",t=r;for(;t--;)e+=li[Math.random()*64|0];return e};function ci(r){var e=typeof r;return r!=null&&(e=="object"||e=="function")}var Mr=ci,di=typeof Bt=="object"&&Bt&&Bt.Object===Object&&Bt,pi=di,hi=pi,fi=typeof self=="object"&&self&&self.Object===Object&&self,mi=hi||fi||Function("return this")(),ys=mi,gi=ys,yi=function(){return gi.Date.now()},vi=yi,_i=/\s/;function bi(r){for(var e=r.length;e--&&_i.test(r.charAt(e)););return e}var wi=bi,Si=wi,Pi=/^\s+/;function Ti(r){return r&&r.slice(0,Si(r)+1).replace(Pi,"")}var Fi=Ti,Ui=ys,Ei=Ui.Symbol,vs=Ei,Gr=vs,_s=Object.prototype,Oi=_s.hasOwnProperty,Ai=_s.toString,nt=Gr?Gr.toStringTag:void 0;function Ci(r){var e=Oi.call(r,nt),t=r[nt];try{r[nt]=void 0;var s=!0}catch{}var i=Ai.call(r);return s&&(e?r[nt]=t:delete r[nt]),i}var $i=Ci,Ri=Object.prototype,xi=Ri.toString;function ki(r){return xi.call(r)}var Mi=ki,Kr=vs,ji=$i,Ni=Mi,Li="[object Null]",Ii="[object Undefined]",Xr=Kr?Kr.toStringTag:void 0;function Bi(r){return r==null?r===void 0?Ii:Li:Xr&&Xr in Object(r)?ji(r):Ni(r)}var zi=Bi;function Di(r){return r!=null&&typeof r=="object"}var qi=Di,Hi=zi,Wi=qi,Gi="[object Symbol]";function Ki(r){return typeof r=="symbol"||Wi(r)&&Hi(r)==Gi}var Xi=Ki,Vi=Fi,Vr=Mr,Ji=Xi,Jr=0/0,Yi=/^[-+]0x[0-9a-f]+$/i,Qi=/^0b[01]+$/i,Zi=/^0o[0-7]+$/i,eo=parseInt;function to(r){if(typeof r=="number")return r;if(Ji(r))return Jr;if(Vr(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Vr(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=Vi(r);var t=Qi.test(r);return t||Zi.test(r)?eo(r.slice(2),t?2:8):Yi.test(r)?Jr:+r}var ro=to,so=Mr,nr=vi,Yr=ro,io="Expected a function",oo=Math.max,no=Math.min;function ao(r,e,t){var s,i,o,n,a,l,c=0,d=!1,u=!1,h=!0;if(typeof r!="function")throw new TypeError(io);e=Yr(e)||0,so(t)&&(d=!!t.leading,u="maxWait"in t,o=u?oo(Yr(t.maxWait)||0,e):o,h="trailing"in t?!!t.trailing:h);function p(U){var F=s,O=i;return s=i=void 0,c=U,n=r.apply(O,F),n}function f(U){return c=U,a=setTimeout(v,e),d?p(U):n}function _(U){var F=U-l,O=U-c,j=e-F;return u?no(j,o-O):j}function b(U){var F=U-l,O=U-c;return l===void 0||F>=e||F<0||u&&O>=o}function v(){var U=nr();if(b(U))return T(U);a=setTimeout(v,_(U))}function T(U){return a=void 0,h&&s?p(U):(s=i=void 0,n)}function R(){a!==void 0&&clearTimeout(a),c=0,s=l=i=a=void 0}function E(){return a===void 0?n:T(nr())}function x(){var U=nr(),F=b(U);if(s=arguments,i=this,l=U,F){if(a===void 0)return f(l);if(u)return clearTimeout(a),a=setTimeout(v,e),p(l)}return a===void 0&&(a=setTimeout(v,e)),n}return x.cancel=R,x.flush=E,x}var lo=ao,uo=lo,co=Mr,po="Expected a function";function ho(r,e,t){var s=!0,i=!0;if(typeof r!="function")throw new TypeError(po);return co(t)&&(s="leading"in t?!!t.leading:s,i="trailing"in t?!!t.trailing:i),uo(r,e,{leading:s,maxWait:e,trailing:i})}var fo=ho;const bs=tt(fo);function Wt(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var mo=0;function ws(r){return"__private_"+mo+++"_"+r}const go={version:"4.1.0"};var Ie=ws("callbacks"),ar=ws("publish");class Ss{constructor(){Object.defineProperty(this,ar,{value:yo}),this.state={},Object.defineProperty(this,Ie,{writable:!0,value:new Set})}getState(){return this.state}setState(e){const t={...this.state},s={...this.state,...e};this.state=s,Wt(this,ar)[ar](t,s,e)}subscribe(e){return Wt(this,Ie)[Ie].add(e),()=>{Wt(this,Ie)[Ie].delete(e)}}}function yo(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];Wt(this,Ie)[Ie].forEach(s=>{s(...e)})}Ss.VERSION=go.version;function Ps(r){const e=r.lastIndexOf(".");return e===-1||e===r.length-1?{name:r,extension:void 0}:{name:r.slice(0,e),extension:r.slice(e+1)}}const Qr={__proto__:null,md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",webp:"image/webp",gif:"image/gif",heic:"image/heic",heif:"image/heif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",dicom:"application/dicom",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel",txt:"text/plain",text:"text/plain",conf:"text/plain",log:"text/plain",pdf:"application/pdf",zip:"application/zip","7z":"application/x-7z-compressed",rar:"application/x-rar-compressed",tar:"application/x-tar",gz:"application/gzip",dmg:"application/x-apple-diskimage"};function Ts(r){var e;if(r.type)return r.type;const t=r.name?(e=Ps(r.name).extension)==null?void 0:e.toLowerCase():null;return t&&t in Qr?Qr[t]:"application/octet-stream"}function vo(r){return r.charCodeAt(0).toString(32)}function Zr(r){let e="";return r.replace(/[^A-Z0-9]/gi,t=>(e+=`-${vo(t)}`,"/"))+e}function _o(r,e){let t=e||"uppy";return typeof r.name=="string"&&(t+=`-${Zr(r.name.toLowerCase())}`),r.type!==void 0&&(t+=`-${r.type}`),r.meta&&typeof r.meta.relativePath=="string"&&(t+=`-${Zr(r.meta.relativePath.toLowerCase())}`),r.data.size!==void 0&&(t+=`-${r.data.size}`),r.data.lastModified!==void 0&&(t+=`-${r.data.lastModified}`),t}function bo(r){return!r.isRemote||!r.remote?!1:new Set(["box","dropbox","drive","facebook","unsplash"]).has(r.remote.provider)}function wo(r,e){if(bo(r))return r.id;const t=Ts(r);return _o({...r,type:t},e)}function So(r){if(r==null&&typeof navigator<"u"&&(r=navigator.userAgent),!r)return!0;const e=/Edge\/(\d+\.\d+)/.exec(r);if(!e)return!0;const s=e[1].split(".",2),i=parseInt(s[0],10),o=parseInt(s[1],10);return i<15||i===15&&o<15063||i>18||i===18&&o>=18218}function Po(r,e){return e.name?e.name:r.split("/")[0]==="image"?`${r.split("/")[0]}.${r.split("/")[1]}`:"noname"}function lr(r){return r<10?`0${r}`:r.toString()}function Gt(){const r=new Date,e=lr(r.getHours()),t=lr(r.getMinutes()),s=lr(r.getSeconds());return`${e}:${t}:${s}`}const To={debug:()=>{},warn:()=>{},error:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.error(`[Uppy] [${Gt()}]`,...e)}},Fo={debug:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.debug(`[Uppy] [${Gt()}]`,...e)},warn:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.warn(`[Uppy] [${Gt()}]`,...e)},error:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return console.error(`[Uppy] [${Gt()}]`,...e)}};var Uo=function(e){if(typeof e!="number"||Number.isNaN(e))throw new TypeError(`Expected a number, got ${typeof e}`);const t=e<0,s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(t&&(e=-e),e<1)return`${(t?"-":"")+e} B`;const i=Math.min(Math.floor(Math.log(e)/Math.log(1024)),s.length-1);e=Number(e/1024**i);const o=s[i];return e>=10||e%1===0?`${(t?"-":"")+e.toFixed(0)} ${o}`:`${(t?"-":"")+e.toFixed(1)} ${o}`};const Ze=tt(Uo);function Fs(r,e){this.text=r=r||"",this.hasWild=~r.indexOf("*"),this.separator=e,this.parts=r.split(e)}Fs.prototype.match=function(r){var e=!0,t=this.parts,s,i=t.length,o;if(typeof r=="string"||r instanceof String)if(!this.hasWild&&this.text!=r)e=!1;else{for(o=(r||"").split(this.separator),s=0;e&&s<i;s++)t[s]!=="*"&&(s<o.length?e=t[s]===o[s]:e=!1);e=e&&o}else if(typeof r.splice=="function")for(e=[],s=r.length;s--;)this.match(r[s])&&(e[e.length]=r[s]);else if(typeof r=="object"){e={};for(var n in r)this.match(n)&&(e[n]=r[n])}return e};var Eo=function(r,e,t){var s=new Fs(r,t||/[\/\.]/);return typeof e<"u"?s.match(e):s},Oo=Eo,Ao=/[\/\+\.]/,Co=function(r,e){function t(s){var i=Oo(s,r,Ao);return i&&i.length>=2}return e?t(e.split(";")[0]):t};const $o=tt(Co),Ro={maxFileSize:null,minFileSize:null,maxTotalFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null,requiredMetaFields:[]};class le extends Error{constructor(e,t){var s;super(e),this.isRestriction=!0,this.isUserFacing=(s=t==null?void 0:t.isUserFacing)!=null?s:!0,t!=null&&t.file&&(this.file=t.file)}}class xo{constructor(e,t){this.getI18n=t,this.getOpts=()=>{var s;const i=e();if(((s=i.restrictions)==null?void 0:s.allowedFileTypes)!=null&&!Array.isArray(i.restrictions.allowedFileTypes))throw new TypeError("`restrictions.allowedFileTypes` must be an array");return i}}validateAggregateRestrictions(e,t){const{maxTotalFileSize:s,maxNumberOfFiles:i}=this.getOpts().restrictions;if(i&&e.filter(n=>!n.isGhost).length+t.length>i)throw new le(`${this.getI18n()("youCanOnlyUploadX",{smart_count:i})}`);if(s){const o=[...e,...t].reduce((n,a)=>{var l;return n+((l=a.size)!=null?l:0)},0);if(o>s)throw new le(this.getI18n()("aggregateExceedsSize",{sizeAllowed:Ze(s),size:Ze(o)}))}}validateSingleFile(e){const{maxFileSize:t,minFileSize:s,allowedFileTypes:i}=this.getOpts().restrictions;if(i&&!i.some(a=>a.includes("/")?e.type?$o(e.type.replace(/;.*?$/,""),a):!1:a[0]==="."&&e.extension?e.extension.toLowerCase()===a.slice(1).toLowerCase():!1)){const a=i.join(", ");throw new le(this.getI18n()("youCanOnlyUploadFileTypes",{types:a}),{file:e})}if(t&&e.size!=null&&e.size>t){var o;throw new le(this.getI18n()("exceedsSize",{size:Ze(t),file:(o=e.name)!=null?o:this.getI18n()("unnamed")}),{file:e})}if(s&&e.size!=null&&e.size<s)throw new le(this.getI18n()("inferiorSize",{size:Ze(s)}),{file:e})}validate(e,t){t.forEach(s=>{this.validateSingleFile(s)}),this.validateAggregateRestrictions(e,t)}validateMinNumberOfFiles(e){const{minNumberOfFiles:t}=this.getOpts().restrictions;if(t&&Object.keys(e).length<t)throw new le(this.getI18n()("youHaveToAtLeastSelectX",{smart_count:t}))}getMissingRequiredMetaFields(e){var t;const s=new le(this.getI18n()("missingRequiredMetaFieldOnFile",{fileName:(t=e.name)!=null?t:this.getI18n()("unnamed")})),{requiredMetaFields:i}=this.getOpts().restrictions,o=[];for(const n of i)(!Object.hasOwn(e.meta,n)||e.meta[n]==="")&&o.push(n);return{missingFields:o,error:s}}}const ko={strings:{addBulkFilesFailed:{0:"Failed to add %{smart_count} file due to an internal error",1:"Failed to add %{smart_count} files due to internal errors"},youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},aggregateExceedsSize:"You selected %{size} of files, but maximum allowed size is %{sizeAllowed}",exceedsSize:"%{file} exceeds maximum allowed size of %{size}",missingRequiredMetaField:"Missing required meta fields",missingRequiredMetaFieldOnFile:"Missing required meta fields in %{fileName}",inferiorSize:"This file is smaller than the allowed size of %{size}",youCanOnlyUploadFileTypes:"You can only upload: %{types}",noMoreFilesAllowed:"Cannot add more files",noDuplicates:"Cannot add the duplicate file '%{fileName}', it already exists",companionError:"Connection with Companion failed",authAborted:"Authentication aborted",companionUnauthorizeHint:"To unauthorize to your %{provider} account, please go to %{url}",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",noSearchResults:"Unfortunately, there are no results for this search",selectX:{0:"Select %{smart_count}",1:"Select %{smart_count}"},allFilesFromFolderNamed:"All files from folder %{name}",openFolderNamed:"Open folder %{name}",cancel:"Cancel",logOut:"Log out",filter:"Filter",resetFilter:"Reset filter",loading:"Loading...",loadedXFiles:"Loaded %{numFiles} files",authenticateWithTitle:"Please authenticate with %{pluginName} to select files",authenticateWith:"Connect to %{pluginName}",signInWithGoogle:"Sign in with Google",searchImages:"Search for images",enterTextToSearch:"Enter text to search for images",search:"Search",resetSearch:"Reset search",emptyFolderAdded:"No files were added from empty folder",addedNumFiles:"Added %{numFiles} file(s)",folderAlreadyAdded:'The folder "%{folder}" was already added',folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"},additionalRestrictionsFailed:"%{count} additional restrictions were not fulfilled",unnamed:"Unnamed"}};function m(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var Mo=0;function k(r){return"__private_"+Mo+++"_"+r}const jo={version:"4.2.0"},zt={totalProgress:0,allowNewUpload:!0,error:null,recoveredState:null};var I=k("plugins"),V=k("restricter"),at=k("storeUnsubscribe"),he=k("emitter"),Be=k("preProcessors"),ze=k("uploaders"),Pe=k("postProcessors"),ie=k("informAndEmit"),kt=k("checkRequiredMetaFieldsOnFile"),ur=k("checkRequiredMetaFields"),lt=k("assertNewUploadAllowed"),Or=k("transformFile"),ut=k("startIfAutoProceed"),ct=k("checkAndUpdateFileState"),cr=k("addListeners"),ce=k("updateOnlineStatus"),dt=k("requestClientById"),fe=k("createUpload"),dr=k("getUpload"),Xe=k("removeUpload"),me=k("runUpload");class Zt{constructor(e){Object.defineProperty(this,me,{value:Xo}),Object.defineProperty(this,Xe,{value:Ko}),Object.defineProperty(this,dr,{value:Go}),Object.defineProperty(this,fe,{value:Wo}),Object.defineProperty(this,cr,{value:Ho}),Object.defineProperty(this,ct,{value:qo}),Object.defineProperty(this,ut,{value:Do}),Object.defineProperty(this,Or,{value:zo}),Object.defineProperty(this,lt,{value:Bo}),Object.defineProperty(this,ur,{value:Io}),Object.defineProperty(this,kt,{value:Lo}),Object.defineProperty(this,ie,{value:No}),Object.defineProperty(this,I,{writable:!0,value:Object.create(null)}),Object.defineProperty(this,V,{writable:!0,value:void 0}),Object.defineProperty(this,at,{writable:!0,value:void 0}),Object.defineProperty(this,he,{writable:!0,value:ai()}),Object.defineProperty(this,Be,{writable:!0,value:new Set}),Object.defineProperty(this,ze,{writable:!0,value:new Set}),Object.defineProperty(this,Pe,{writable:!0,value:new Set}),this.scheduledAutoProceed=null,this.wasOffline=!1,this.calculateProgress=bs((i,o)=>{const n=this.getFile(i==null?void 0:i.id);if(i==null||!n){this.log(`Not setting progress for a file that has been removed: ${i==null?void 0:i.id}`);return}if(n.progress.percentage===100){this.log(`Not setting progress for a file that has been already uploaded: ${i.id}`);return}const a=Number.isFinite(o.bytesTotal)&&o.bytesTotal>0;this.setFileState(i.id,{progress:{...n.progress,bytesUploaded:o.bytesUploaded,bytesTotal:o.bytesTotal,percentage:a?Math.round(o.bytesUploaded/o.bytesTotal*100):0}}),this.calculateTotalProgress()},500,{leading:!0,trailing:!0}),Object.defineProperty(this,ce,{writable:!0,value:this.updateOnlineStatus.bind(this)}),Object.defineProperty(this,dt,{writable:!0,value:new Map}),this.defaultLocale=ko;const t={id:"uppy",autoProceed:!1,allowMultipleUploadBatches:!0,debug:!1,restrictions:Ro,meta:{},onBeforeFileAdded:(i,o)=>!Object.hasOwn(o,i.id),onBeforeUpload:i=>i,store:new Ss,logger:To,infoTimeout:5e3},s={...t,...e};this.opts={...s,restrictions:{...t.restrictions,...e&&e.restrictions}},e&&e.logger&&e.debug?this.log("You are using a custom `logger`, but also set `debug: true`, which uses built-in logger to output logs to console. Ignoring `debug: true` and using your custom `logger`.","warning"):e&&e.debug&&(this.opts.logger=Fo),this.log(`Using Core v${Zt.VERSION}`),this.i18nInit(),this.store=this.opts.store,this.setState({...zt,plugins:{},files:{},currentUploads:{},capabilities:{uploadProgress:So(),individualCancellation:!0,resumableUploads:!1},meta:{...this.opts.meta},info:[]}),m(this,V)[V]=new xo(()=>this.opts,()=>this.i18n),m(this,at)[at]=this.store.subscribe((i,o,n)=>{this.emit("state-update",i,o,n),this.updateAll(o)}),this.opts.debug&&typeof window<"u"&&(window[this.opts.id]=this),m(this,cr)[cr]()}emit(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];m(this,he)[he].emit(e,...s)}on(e,t){return m(this,he)[he].on(e,t),this}once(e,t){return m(this,he)[he].once(e,t),this}off(e,t){return m(this,he)[he].off(e,t),this}updateAll(e){this.iteratePlugins(t=>{t.update(e)})}setState(e){this.store.setState(e)}getState(){return this.store.getState()}patchFilesState(e){const t=this.getState().files;this.setState({files:{...t,...Object.fromEntries(Object.entries(e).map(s=>{let[i,o]=s;return[i,{...t[i],...o}]}))}})}setFileState(e,t){if(!this.getState().files[e])throw new Error(`Can’t set state for ${e} (the file could have been removed)`);this.patchFilesState({[e]:t})}i18nInit(){const e=s=>this.log(`Missing i18n string: ${s}`,"error"),t=new gs([this.defaultLocale,this.opts.locale],{onMissingKey:e});this.i18n=t.translate.bind(t),this.i18nArray=t.translateArray.bind(t),this.locale=t.locale}setOptions(e){this.opts={...this.opts,...e,restrictions:{...this.opts.restrictions,...e==null?void 0:e.restrictions}},e.meta&&this.setMeta(e.meta),this.i18nInit(),e.locale&&this.iteratePlugins(t=>{t.setOptions(e)}),this.setState(void 0)}resetProgress(){const e={percentage:0,bytesUploaded:!1,uploadComplete:!1,uploadStarted:null},t={...this.getState().files},s=Object.create(null);Object.keys(t).forEach(i=>{s[i]={...t[i],progress:{...t[i].progress,...e}}}),this.setState({files:s,...zt})}clear(){const{capabilities:e,currentUploads:t}=this.getState();if(Object.keys(t).length>0&&!e.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");this.setState({...zt,files:{}})}addPreProcessor(e){m(this,Be)[Be].add(e)}removePreProcessor(e){return m(this,Be)[Be].delete(e)}addPostProcessor(e){m(this,Pe)[Pe].add(e)}removePostProcessor(e){return m(this,Pe)[Pe].delete(e)}addUploader(e){m(this,ze)[ze].add(e)}removeUploader(e){return m(this,ze)[ze].delete(e)}setMeta(e){const t={...this.getState().meta,...e},s={...this.getState().files};Object.keys(s).forEach(i=>{s[i]={...s[i],meta:{...s[i].meta,...e}}}),this.log("Adding metadata:"),this.log(e),this.setState({meta:t,files:s})}setFileMeta(e,t){const s={...this.getState().files};if(!s[e]){this.log("Was trying to set metadata for a file that has been removed: ",e);return}const i={...s[e].meta,...t};s[e]={...s[e],meta:i},this.setState({files:s})}getFile(e){return this.getState().files[e]}getFiles(){const{files:e}=this.getState();return Object.values(e)}getFilesByIds(e){return e.map(t=>this.getFile(t))}getObjectOfFilesPerState(){const{files:e,totalProgress:t,error:s}=this.getState(),i=Object.values(e),o=[],n=[],a=[],l=[],c=[],d=[],u=[],h=[],p=[];for(const f of i){const{progress:_}=f;!_.uploadComplete&&_.uploadStarted&&(o.push(f),f.isPaused||h.push(f)),_.uploadStarted||n.push(f),(_.uploadStarted||_.preprocess||_.postprocess)&&a.push(f),_.uploadStarted&&l.push(f),f.isPaused&&c.push(f),_.uploadComplete&&d.push(f),f.error&&u.push(f),(_.preprocess||_.postprocess)&&p.push(f)}return{newFiles:n,startedFiles:a,uploadStartedFiles:l,pausedFiles:c,completeFiles:d,erroredFiles:u,inProgressFiles:o,inProgressNotPausedFiles:h,processingFiles:p,isUploadStarted:l.length>0,isAllComplete:t===100&&d.length===i.length&&p.length===0,isAllErrored:!!s&&u.length===i.length,isAllPaused:o.length!==0&&c.length===o.length,isUploadInProgress:o.length>0,isSomeGhost:i.some(f=>f.isGhost)}}validateSingleFile(e){try{m(this,V)[V].validateSingleFile(e)}catch(t){return t.message}return null}validateAggregateRestrictions(e){const t=this.getFiles();try{m(this,V)[V].validateAggregateRestrictions(t,e)}catch(s){return s.message}return null}checkIfFileAlreadyExists(e){const{files:t}=this.getState();return!!(t[e]&&!t[e].isGhost)}addFile(e){m(this,lt)[lt](e);const{nextFilesState:t,validFilesToAdd:s,errors:i}=m(this,ct)[ct]([e]),o=i.filter(a=>a.isRestriction);if(m(this,ie)[ie](o),i.length>0)throw i[0];this.setState({files:t});const[n]=s;return this.emit("file-added",n),this.emit("files-added",s),this.log(`Added file: ${n.name}, ${n.id}, mime type: ${n.type}`),m(this,ut)[ut](),n.id}addFiles(e){m(this,lt)[lt]();const{nextFilesState:t,validFilesToAdd:s,errors:i}=m(this,ct)[ct](e),o=i.filter(a=>a.isRestriction);m(this,ie)[ie](o);const n=i.filter(a=>!a.isRestriction);if(n.length>0){let a=`Multiple errors occurred while adding files:
`;if(n.forEach(l=>{a+=`
 * ${l.message}`}),this.info({message:this.i18n("addBulkFilesFailed",{smart_count:n.length}),details:a},"error",this.opts.infoTimeout),typeof AggregateError=="function")throw new AggregateError(n,a);{const l=new Error(a);throw l.errors=n,l}}this.setState({files:t}),s.forEach(a=>{this.emit("file-added",a)}),this.emit("files-added",s),s.length>5?this.log(`Added batch of ${s.length} files`):Object.values(s).forEach(a=>{this.log(`Added file: ${a.name}
 id: ${a.id}
 type: ${a.type}`)}),s.length>0&&m(this,ut)[ut]()}removeFiles(e){const{files:t,currentUploads:s}=this.getState(),i={...t},o={...s},n=Object.create(null);e.forEach(d=>{t[d]&&(n[d]=t[d],delete i[d])});function a(d){return n[d]===void 0}Object.keys(o).forEach(d=>{const u=s[d].fileIDs.filter(a);if(u.length===0){delete o[d];return}const{capabilities:h}=this.getState();if(u.length!==s[d].fileIDs.length&&!h.individualCancellation)throw new Error("The installed uploader plugin does not allow removing files during an upload.");o[d]={...s[d],fileIDs:u}});const l={currentUploads:o,files:i};Object.keys(i).length===0&&(l.allowNewUpload=!0,l.error=null,l.recoveredState=null),this.setState(l),this.calculateTotalProgress();const c=Object.keys(n);c.forEach(d=>{this.emit("file-removed",n[d])}),c.length>5?this.log(`Removed ${c.length} files`):this.log(`Removed files: ${c.join(", ")}`)}removeFile(e){this.removeFiles([e])}pauseResume(e){if(!this.getState().capabilities.resumableUploads||this.getFile(e).progress.uploadComplete)return;const t=this.getFile(e),i=!(t.isPaused||!1);return this.setFileState(e,{isPaused:i}),this.emit("upload-pause",t,i),i}pauseAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const i={...e[s],isPaused:!0};e[s]=i}),this.setState({files:e}),this.emit("pause-all")}resumeAll(){const e={...this.getState().files};Object.keys(e).filter(s=>!e[s].progress.uploadComplete&&e[s].progress.uploadStarted).forEach(s=>{const i={...e[s],isPaused:!1,error:null};e[s]=i}),this.setState({files:e}),this.emit("resume-all")}retryAll(){const e={...this.getState().files},t=Object.keys(e).filter(i=>e[i].error);if(t.forEach(i=>{const o={...e[i],isPaused:!1,error:null};e[i]=o}),this.setState({files:e,error:null}),this.emit("retry-all",Object.values(e)),t.length===0)return Promise.resolve({successful:[],failed:[]});const s=m(this,fe)[fe](t,{forceAllowNewUpload:!0});return m(this,me)[me](s)}cancelAll(){this.emit("cancel-all");const{files:e}=this.getState(),t=Object.keys(e);t.length&&this.removeFiles(t),this.setState(zt)}retryUpload(e){this.setFileState(e,{error:null,isPaused:!1}),this.emit("upload-retry",this.getFile(e));const t=m(this,fe)[fe]([e],{forceAllowNewUpload:!0});return m(this,me)[me](t)}logout(){this.iteratePlugins(e=>{var t;(t=e.provider)==null||t.logout==null||t.logout()})}calculateTotalProgress(){const t=this.getFiles().filter(c=>c.progress.uploadStarted||c.progress.preprocess||c.progress.postprocess);if(t.length===0){this.emit("progress",0),this.setState({totalProgress:0});return}const s=t.filter(c=>c.progress.bytesTotal!=null),i=t.filter(c=>c.progress.bytesTotal==null);if(s.length===0){const c=t.length*100,d=i.reduce((h,p)=>h+p.progress.percentage,0),u=Math.round(d/c*100);this.setState({totalProgress:u});return}let o=s.reduce((c,d)=>{var u;return c+((u=d.progress.bytesTotal)!=null?u:0)},0);const n=o/s.length;o+=n*i.length;let a=0;s.forEach(c=>{a+=c.progress.bytesUploaded}),i.forEach(c=>{a+=n*(c.progress.percentage||0)/100});let l=o===0?0:Math.round(a/o*100);l>100&&(l=100),this.setState({totalProgress:l}),this.emit("progress",l)}updateOnlineStatus(){var e;((e=window.navigator.onLine)!=null?e:!0)?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)}getID(){return this.opts.id}use(e){if(typeof e!="function"){const l=`Expected a plugin class, but got ${e===null?"null":typeof e}. Please verify that the plugin was imported and spelled correctly.`;throw new TypeError(l)}for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];const o=new e(this,...s),n=o.id;if(!n)throw new Error("Your plugin must have an id");if(!o.type)throw new Error("Your plugin must have a type");const a=this.getPlugin(n);if(a){const l=`Already found a plugin named '${a.id}'. Tried to use: '${n}'.
Uppy plugins must have unique \`id\` options.`;throw new Error(l)}return e.VERSION&&this.log(`Using ${n} v${e.VERSION}`),o.type in m(this,I)[I]?m(this,I)[I][o.type].push(o):m(this,I)[I][o.type]=[o],o.install(),this.emit("plugin-added",o),this}getPlugin(e){for(const t of Object.values(m(this,I)[I])){const s=t.find(i=>i.id===e);if(s!=null)return s}}[Symbol.for("uppy test: getPlugins")](e){return m(this,I)[I][e]}iteratePlugins(e){Object.values(m(this,I)[I]).flat(1).forEach(e)}removePlugin(e){this.log(`Removing plugin ${e.id}`),this.emit("plugin-remove",e),e.uninstall&&e.uninstall();const t=m(this,I)[I][e.type],s=t.findIndex(n=>n.id===e.id);s!==-1&&t.splice(s,1);const o={plugins:{...this.getState().plugins,[e.id]:void 0}};this.setState(o)}destroy(){this.log(`Closing Uppy instance ${this.opts.id}: removing all files and uninstalling plugins`),this.cancelAll(),m(this,at)[at](),this.iteratePlugins(e=>{this.removePlugin(e)}),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("online",m(this,ce)[ce]),window.removeEventListener("offline",m(this,ce)[ce]))}hideInfo(){const{info:e}=this.getState();this.setState({info:e.slice(1)}),this.emit("info-hidden")}info(e,t,s){t===void 0&&(t="info"),s===void 0&&(s=3e3);const i=typeof e=="object";this.setState({info:[...this.getState().info,{type:t,message:i?e.message:e,details:i?e.details:null}]}),setTimeout(()=>this.hideInfo(),s),this.emit("info-visible")}log(e,t){const{logger:s}=this.opts;switch(t){case"error":s.error(e);break;case"warning":s.warn(e);break;default:s.debug(e);break}}registerRequestClient(e,t){m(this,dt)[dt].set(e,t)}getRequestClientForFile(e){if(!e.remote)throw new Error(`Tried to get RequestClient for a non-remote file ${e.id}`);const t=m(this,dt)[dt].get(e.remote.requestClientId);if(t==null)throw new Error(`requestClientId "${e.remote.requestClientId}" not registered for file "${e.id}"`);return t}restore(e){return this.log(`Core: attempting to restore upload "${e}"`),this.getState().currentUploads[e]?m(this,me)[me](e):(m(this,Xe)[Xe](e),Promise.reject(new Error("Nonexistent upload")))}[Symbol.for("uppy test: createUpload")](){return m(this,fe)[fe](...arguments)}addResultData(e,t){if(!m(this,dr)[dr](e)){this.log(`Not setting result for an upload that has been removed: ${e}`);return}const{currentUploads:s}=this.getState(),i={...s[e],result:{...s[e].result,...t}};this.setState({currentUploads:{...s,[e]:i}})}upload(){var e;(e=m(this,I)[I].uploader)!=null&&e.length||this.log("No uploader type plugins are used","warning");let{files:t}=this.getState();const s=this.opts.onBeforeUpload(t);return s===!1?Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false")):(s&&typeof s=="object"&&(t=s,this.setState({files:t})),Promise.resolve().then(()=>m(this,V)[V].validateMinNumberOfFiles(t)).catch(i=>{throw m(this,ie)[ie]([i]),i}).then(()=>{if(!m(this,ur)[ur](t))throw new le(this.i18n("missingRequiredMetaField"))}).catch(i=>{throw i}).then(()=>{const{currentUploads:i}=this.getState(),o=Object.values(i).flatMap(l=>l.fileIDs),n=[];Object.keys(t).forEach(l=>{const c=this.getFile(l);!c.progress.uploadStarted&&o.indexOf(l)===-1&&n.push(c.id)});const a=m(this,fe)[fe](n);return m(this,me)[me](a)}).catch(i=>{throw this.emit("error",i),this.log(i,"error"),i}))}}function No(r){for(const o of r)o.isRestriction?this.emit("restriction-failed",o.file,o):this.emit("error",o,o.file),this.log(o,"warning");const e=r.filter(o=>o.isUserFacing),t=4,s=e.slice(0,t),i=e.slice(t);s.forEach(o=>{let{message:n,details:a=""}=o;this.info({message:n,details:a},"error",this.opts.infoTimeout)}),i.length>0&&this.info({message:this.i18n("additionalRestrictionsFailed",{count:i.length})})}function Lo(r){const{missingFields:e,error:t}=m(this,V)[V].getMissingRequiredMetaFields(r);return e.length>0?(this.setFileState(r.id,{missingRequiredMetaFields:e}),this.log(t.message),this.emit("restriction-failed",r,t),!1):!0}function Io(r){let e=!0;for(const t of Object.values(r))m(this,kt)[kt](t)||(e=!1);return e}function Bo(r){const{allowNewUpload:e}=this.getState();if(e===!1){const t=new le(this.i18n("noMoreFilesAllowed"),{file:r});throw m(this,ie)[ie]([t]),t}}function zo(r){const e=r instanceof File?{name:r.name,type:r.type,size:r.size,data:r}:r,t=Ts(e),s=Po(t,e),i=Ps(s).extension,o=wo(e,this.getID()),n=e.meta||{};n.name=s,n.type=t;const a=Number.isFinite(e.data.size)?e.data.size:null;return{source:e.source||"",id:o,name:s,extension:i||"",meta:{...this.getState().meta,...n},type:t,data:e.data,progress:{percentage:0,bytesUploaded:!1,bytesTotal:a,uploadComplete:!1,uploadStarted:null},size:a,isGhost:!1,isRemote:e.isRemote||!1,remote:e.remote,preview:e.preview}}function Do(){this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(()=>{this.scheduledAutoProceed=null,this.upload().catch(r=>{r.isRestriction||this.log(r.stack||r.message||r)})},4))}function qo(r){const{files:e}=this.getState(),t={...e},s=[],i=[];for(const a of r)try{var o;let l=m(this,Or)[Or](a);const c=(o=e[l.id])==null?void 0:o.isGhost;c&&(l={...e[l.id],isGhost:!1,data:a.data},this.log(`Replaced the blob in the restored ghost file: ${l.name}, ${l.id}`));const d=this.opts.onBeforeFileAdded(l,t);if(!d&&this.checkIfFileAlreadyExists(l.id)){var n;throw new le(this.i18n("noDuplicates",{fileName:(n=l.name)!=null?n:this.i18n("unnamed")}),{file:a})}if(d===!1&&!c)throw new le("Cannot add the file because onBeforeFileAdded returned false.",{isUserFacing:!1,file:a});typeof d=="object"&&d!==null&&(l=d),m(this,V)[V].validateSingleFile(l),t[l.id]=l,s.push(l)}catch(l){i.push(l)}try{m(this,V)[V].validateAggregateRestrictions(Object.values(e),s)}catch(a){return i.push(a),{nextFilesState:e,validFilesToAdd:[],errors:i}}return{nextFilesState:t,validFilesToAdd:s,errors:i}}function Ho(){const r=(s,i,o)=>{let n=s.message||"Unknown error";s.details&&(n+=` ${s.details}`),this.setState({error:n}),i!=null&&i.id in this.getState().files&&this.setFileState(i.id,{error:n,response:o})};this.on("error",r),this.on("upload-error",(s,i,o)=>{if(r(i,s,o),typeof i=="object"&&i.message){var n;this.log(i.message,"error");const a=new Error(this.i18n("failedToUpload",{file:(n=s==null?void 0:s.name)!=null?n:""}));a.isUserFacing=!0,a.details=i.message,i.details&&(a.details+=` ${i.details}`),m(this,ie)[ie]([a])}else m(this,ie)[ie]([i])});let e=null;this.on("upload-stalled",(s,i)=>{const{message:o}=s,n=i.map(a=>a.meta.name).join(", ");e||(this.info({message:o,details:n},"warning",this.opts.infoTimeout),e=setTimeout(()=>{e=null},this.opts.infoTimeout)),this.log(`${o} ${n}`.trim(),"warning")}),this.on("upload",()=>{this.setState({error:null})});const t=s=>{const i=s.filter(n=>{const a=n!=null&&this.getFile(n.id);return a||this.log(`Not setting progress for a file that has been removed: ${n==null?void 0:n.id}`),a}),o=Object.fromEntries(i.map(n=>[n.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:n.size}}]));this.patchFilesState(o)};this.on("upload-start",t),this.on("upload-progress",this.calculateProgress),this.on("upload-success",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const o=this.getFile(s.id).progress;this.setFileState(s.id,{progress:{...o,postprocess:m(this,Pe)[Pe].size>0?{mode:"indeterminate"}:void 0,uploadComplete:!0,percentage:100,bytesUploaded:o.bytesTotal},response:i,uploadURL:i.uploadURL,isPaused:!1}),s.size==null&&this.setFileState(s.id,{size:i.bytesUploaded||o.bytesTotal}),this.calculateTotalProgress()}),this.on("preprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}this.setFileState(s.id,{progress:{...this.getFile(s.id).progress,preprocess:i}})}),this.on("preprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.preprocess,this.setState({files:i})}),this.on("postprocess-progress",(s,i)=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}this.setFileState(s.id,{progress:{...this.getState().files[s.id].progress,postprocess:i}})}),this.on("postprocess-complete",s=>{if(s==null||!this.getFile(s.id)){this.log(`Not setting progress for a file that has been removed: ${s==null?void 0:s.id}`);return}const i={...this.getState().files};i[s.id]={...i[s.id],progress:{...i[s.id].progress}},delete i[s.id].progress.postprocess,this.setState({files:i})}),this.on("restored",()=>{this.calculateTotalProgress()}),this.on("dashboard:file-edit-complete",s=>{s&&m(this,kt)[kt](s)}),typeof window<"u"&&window.addEventListener&&(window.addEventListener("online",m(this,ce)[ce]),window.addEventListener("offline",m(this,ce)[ce]),setTimeout(m(this,ce)[ce],3e3))}function Wo(r,e){e===void 0&&(e={});const{forceAllowNewUpload:t=!1}=e,{allowNewUpload:s,currentUploads:i}=this.getState();if(!s&&!t)throw new Error("Cannot create a new upload: already uploading.");const o=ui();return this.emit("upload",o,this.getFilesByIds(r)),this.setState({allowNewUpload:this.opts.allowMultipleUploadBatches!==!1&&this.opts.allowMultipleUploads!==!1,currentUploads:{...i,[o]:{fileIDs:r,step:0,result:{}}}}),o}function Go(r){const{currentUploads:e}=this.getState();return e[r]}function Ko(r){const e={...this.getState().currentUploads};delete e[r],this.setState({currentUploads:e})}async function Xo(r){const e=()=>{const{currentUploads:o}=this.getState();return o[r]};let t=e();const s=[...m(this,Be)[Be],...m(this,ze)[ze],...m(this,Pe)[Pe]];try{for(let o=t.step||0;o<s.length&&t;o++){const n=s[o];this.setState({currentUploads:{...this.getState().currentUploads,[r]:{...t,step:o}}});const{fileIDs:a}=t;await n(a,r),t=e()}}catch(o){throw m(this,Xe)[Xe](r),o}if(t){t.fileIDs.forEach(l=>{const c=this.getFile(l);c&&c.progress.postprocess&&this.emit("postprocess-complete",c)});const o=t.fileIDs.map(l=>this.getFile(l)),n=o.filter(l=>!l.error),a=o.filter(l=>l.error);this.addResultData(r,{successful:n,failed:a,uploadID:r}),t=e()}let i;return t&&(i=t.result,this.emit("complete",i),m(this,Xe)[Xe](r)),i==null&&this.log(`Not setting result for an upload that has been removed: ${r}`),i}Zt.VERSION=jo.version;const Vo=Zt;var er,C,Us,De,es,Es,Ar,jr,Cr,$r,Mt={},Os=[],Jo=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Nr=Array.isArray;function Ue(r,e){for(var t in e)r[t]=e[t];return r}function As(r){r&&r.parentNode&&r.parentNode.removeChild(r)}function y(r,e,t){var s,i,o,n={};for(o in e)o=="key"?s=e[o]:o=="ref"?i=e[o]:n[o]=e[o];if(arguments.length>2&&(n.children=arguments.length>3?er.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(o in r.defaultProps)n[o]===void 0&&(n[o]=r.defaultProps[o]);return Kt(r,n,s,i,null)}function Kt(r,e,t,s,i){var o={type:r,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:i??++Us,__i:-1,__u:0};return i==null&&C.vnode!=null&&C.vnode(o),o}function tr(r){return r.children}function Xt(r,e){this.props=r,this.context=e}function et(r,e){if(e==null)return r.__?et(r.__,r.__i+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?et(r):null}function Cs(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return Cs(r)}}function ts(r){(!r.__d&&(r.__d=!0)&&De.push(r)&&!Jt.__r++||es!==C.debounceRendering)&&((es=C.debounceRendering)||Es)(Jt)}function Jt(){var r,e,t,s,i,o,n,a;for(De.sort(Ar);r=De.shift();)r.__d&&(e=De.length,s=void 0,o=(i=(t=r).__v).__e,n=[],a=[],t.__P&&((s=Ue({},i)).__v=i.__v+1,C.vnode&&C.vnode(s),Lr(t.__P,s,i,t.__n,t.__P.namespaceURI,32&i.__u?[o]:null,n,o??et(i),!!(32&i.__u),a),s.__v=i.__v,s.__.__k[s.__i]=s,xs(n,s,a),s.__e!=o&&Cs(s)),De.length>e&&De.sort(Ar));Jt.__r=0}function $s(r,e,t,s,i,o,n,a,l,c,d){var u,h,p,f,_,b=s&&s.__k||Os,v=e.length;for(t.__d=l,Yo(t,e,b),l=t.__d,u=0;u<v;u++)(p=t.__k[u])!=null&&(h=p.__i===-1?Mt:b[p.__i]||Mt,p.__i=u,Lr(r,p,h,i,o,n,a,l,c,d),f=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&Ir(h.ref,null,p),d.push(p.ref,p.__c||f,p)),_==null&&f!=null&&(_=f),65536&p.__u||h.__k===p.__k?l=Rs(p,l,r):typeof p.type=="function"&&p.__d!==void 0?l=p.__d:f&&(l=f.nextSibling),p.__d=void 0,p.__u&=-196609);t.__d=l,t.__e=_}function Yo(r,e,t){var s,i,o,n,a,l=e.length,c=t.length,d=c,u=0;for(r.__k=[],s=0;s<l;s++)(i=e[s])!=null&&typeof i!="boolean"&&typeof i!="function"?(n=s+u,(i=r.__k[s]=typeof i=="string"||typeof i=="number"||typeof i=="bigint"||i.constructor==String?Kt(null,i,null,null,null):Nr(i)?Kt(tr,{children:i},null,null,null):i.constructor===void 0&&i.__b>0?Kt(i.type,i.props,i.key,i.ref?i.ref:null,i.__v):i).__=r,i.__b=r.__b+1,o=null,(a=i.__i=Qo(i,t,n,d))!==-1&&(d--,(o=t[a])&&(o.__u|=131072)),o==null||o.__v===null?(a==-1&&u--,typeof i.type!="function"&&(i.__u|=65536)):a!==n&&(a==n-1?u--:a==n+1?u++:(a>n?u--:u++,i.__u|=65536))):i=r.__k[s]=null;if(d)for(s=0;s<c;s++)(o=t[s])!=null&&!(131072&o.__u)&&(o.__e==r.__d&&(r.__d=et(o)),ks(o,o))}function Rs(r,e,t){var s,i;if(typeof r.type=="function"){for(s=r.__k,i=0;s&&i<s.length;i++)s[i]&&(s[i].__=r,e=Rs(s[i],e,t));return e}r.__e!=e&&(e&&r.type&&!t.contains(e)&&(e=et(r)),t.insertBefore(r.__e,e||null),e=r.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType===8);return e}function Qo(r,e,t,s){var i=r.key,o=r.type,n=t-1,a=t+1,l=e[t];if(l===null||l&&i==l.key&&o===l.type&&!(131072&l.__u))return t;if(s>(l!=null&&!(131072&l.__u)?1:0))for(;n>=0||a<e.length;){if(n>=0){if((l=e[n])&&!(131072&l.__u)&&i==l.key&&o===l.type)return n;n--}if(a<e.length){if((l=e[a])&&!(131072&l.__u)&&i==l.key&&o===l.type)return a;a++}}return-1}function rs(r,e,t){e[0]==="-"?r.setProperty(e,t??""):r[e]=t==null?"":typeof t!="number"||Jo.test(e)?t:t+"px"}function Dt(r,e,t,s,i){var o;e:if(e==="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof s=="string"&&(r.style.cssText=s=""),s)for(e in s)t&&e in t||rs(r.style,e,"");if(t)for(e in t)s&&t[e]===s[e]||rs(r.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/(PointerCapture)$|Capture$/i,"$1")),e=e.toLowerCase()in r||e==="onFocusOut"||e==="onFocusIn"?e.toLowerCase().slice(2):e.slice(2),r.l||(r.l={}),r.l[e+o]=t,t?s?t.u=s.u:(t.u=jr,r.addEventListener(e,o?$r:Cr,o)):r.removeEventListener(e,o?$r:Cr,o);else{if(i=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in r)try{r[e]=t??"";break e}catch{}typeof t=="function"||(t==null||t===!1&&e[4]!=="-"?r.removeAttribute(e):r.setAttribute(e,e=="popover"&&t==1?"":t))}}function ss(r){return function(e){if(this.l){var t=this.l[e.type+r];if(e.t==null)e.t=jr++;else if(e.t<t.u)return;return t(C.event?C.event(e):e)}}}function Lr(r,e,t,s,i,o,n,a,l,c){var d,u,h,p,f,_,b,v,T,R,E,x,U,F,O,j,M=e.type;if(e.constructor!==void 0)return null;128&t.__u&&(l=!!(32&t.__u),o=[a=e.__e=t.__e]),(d=C.__b)&&d(e);e:if(typeof M=="function")try{if(v=e.props,T="prototype"in M&&M.prototype.render,R=(d=M.contextType)&&s[d.__c],E=d?R?R.props.value:d.__:s,t.__c?b=(u=e.__c=t.__c).__=u.__E:(T?e.__c=u=new M(v,E):(e.__c=u=new Xt(v,E),u.constructor=M,u.render=en),R&&R.sub(u),u.props=v,u.state||(u.state={}),u.context=E,u.__n=s,h=u.__d=!0,u.__h=[],u._sb=[]),T&&u.__s==null&&(u.__s=u.state),T&&M.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Ue({},u.__s)),Ue(u.__s,M.getDerivedStateFromProps(v,u.__s))),p=u.props,f=u.state,u.__v=e,h)T&&M.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),T&&u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(T&&M.getDerivedStateFromProps==null&&v!==p&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(v,E),!u.__e&&(u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(v,u.__s,E)===!1||e.__v===t.__v)){for(e.__v!==t.__v&&(u.props=v,u.state=u.__s,u.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.some(function(Fe){Fe&&(Fe.__=e)}),x=0;x<u._sb.length;x++)u.__h.push(u._sb[x]);u._sb=[],u.__h.length&&n.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(v,u.__s,E),T&&u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(p,f,_)})}if(u.context=E,u.props=v,u.__P=r,u.__e=!1,U=C.__r,F=0,T){for(u.state=u.__s,u.__d=!1,U&&U(e),d=u.render(u.props,u.state,u.context),O=0;O<u._sb.length;O++)u.__h.push(u._sb[O]);u._sb=[]}else do u.__d=!1,U&&U(e),d=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++F<25);u.state=u.__s,u.getChildContext!=null&&(s=Ue(Ue({},s),u.getChildContext())),T&&!h&&u.getSnapshotBeforeUpdate!=null&&(_=u.getSnapshotBeforeUpdate(p,f)),$s(r,Nr(j=d!=null&&d.type===tr&&d.key==null?d.props.children:d)?j:[j],e,t,s,i,o,n,a,l,c),u.base=e.__e,e.__u&=-161,u.__h.length&&n.push(u),b&&(u.__E=u.__=null)}catch(Fe){if(e.__v=null,l||o!=null){for(e.__u|=l?160:32;a&&a.nodeType===8&&a.nextSibling;)a=a.nextSibling;o[o.indexOf(a)]=null,e.__e=a}else e.__e=t.__e,e.__k=t.__k;C.__e(Fe,e,t)}else o==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=Zo(t.__e,e,t,s,i,o,n,l,c);(d=C.diffed)&&d(e)}function xs(r,e,t){e.__d=void 0;for(var s=0;s<t.length;s++)Ir(t[s],t[++s],t[++s]);C.__c&&C.__c(e,r),r.some(function(i){try{r=i.__h,i.__h=[],r.some(function(o){o.call(i)})}catch(o){C.__e(o,i.__v)}})}function Zo(r,e,t,s,i,o,n,a,l){var c,d,u,h,p,f,_,b=t.props,v=e.props,T=e.type;if(T==="svg"?i="http://www.w3.org/2000/svg":T==="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),o!=null){for(c=0;c<o.length;c++)if((p=o[c])&&"setAttribute"in p==!!T&&(T?p.localName===T:p.nodeType===3)){r=p,o[c]=null;break}}if(r==null){if(T===null)return document.createTextNode(v);r=document.createElementNS(i,T,v.is&&v),a&&(C.__m&&C.__m(e,o),a=!1),o=null}if(T===null)b===v||a&&r.data===v||(r.data=v);else{if(o=o&&er.call(r.childNodes),b=t.props||Mt,!a&&o!=null)for(b={},c=0;c<r.attributes.length;c++)b[(p=r.attributes[c]).name]=p.value;for(c in b)if(p=b[c],c!="children"){if(c=="dangerouslySetInnerHTML")u=p;else if(!(c in v)){if(c=="value"&&"defaultValue"in v||c=="checked"&&"defaultChecked"in v)continue;Dt(r,c,null,p,i)}}for(c in v)p=v[c],c=="children"?h=p:c=="dangerouslySetInnerHTML"?d=p:c=="value"?f=p:c=="checked"?_=p:a&&typeof p!="function"||b[c]===p||Dt(r,c,p,b[c],i);if(d)a||u&&(d.__html===u.__html||d.__html===r.innerHTML)||(r.innerHTML=d.__html),e.__k=[];else if(u&&(r.innerHTML=""),$s(r,Nr(h)?h:[h],e,t,s,T==="foreignObject"?"http://www.w3.org/1999/xhtml":i,o,n,o?o[0]:t.__k&&et(t,0),a,l),o!=null)for(c=o.length;c--;)As(o[c]);a||(c="value",T==="progress"&&f==null?r.removeAttribute("value"):f!==void 0&&(f!==r[c]||T==="progress"&&!f||T==="option"&&f!==b[c])&&Dt(r,c,f,b[c],i),c="checked",_!==void 0&&_!==r[c]&&Dt(r,c,_,b[c],i))}return r}function Ir(r,e,t){try{if(typeof r=="function"){var s=typeof r.__u=="function";s&&r.__u(),s&&e==null||(r.__u=r(e))}else r.current=e}catch(i){C.__e(i,t)}}function ks(r,e,t){var s,i;if(C.unmount&&C.unmount(r),(s=r.ref)&&(s.current&&s.current!==r.__e||Ir(s,null,e)),(s=r.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(o){C.__e(o,e)}s.base=s.__P=null}if(s=r.__k)for(i=0;i<s.length;i++)s[i]&&ks(s[i],e,t||typeof r.type!="function");t||As(r.__e),r.__c=r.__=r.__e=r.__d=void 0}function en(r,e,t){return this.constructor(r,t)}function is(r,e,t){var s,i,o,n;C.__&&C.__(r,e),i=(s=typeof t=="function")?null:t&&t.__k||e.__k,o=[],n=[],Lr(e,r=(!s&&t||e).__k=y(tr,null,[r]),i||Mt,Mt,e.namespaceURI,!s&&t?[t]:i?null:e.firstChild?er.call(e.childNodes):null,o,!s&&t?t:i?i.__e:e.firstChild,s,n),xs(o,r,n)}er=Os.slice,C={__e:function(r,e,t,s){for(var i,o,n;e=e.__;)if((i=e.__c)&&!i.__)try{if((o=i.constructor)&&o.getDerivedStateFromError!=null&&(i.setState(o.getDerivedStateFromError(r)),n=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(r,s||{}),n=i.__d),n)return i.__E=i}catch(a){r=a}throw r}},Us=0,Xt.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Ue({},this.state),typeof r=="function"&&(r=r(Ue({},t),this.props)),r&&Ue(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),ts(this))},Xt.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),ts(this))},Xt.prototype.render=tr,De=[],Es=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ar=function(r,e){return r.__v.__b-e.__v.__b},Jt.__r=0,jr=0,Cr=ss(!1),$r=ss(!0);function tn(r){return typeof r!="object"||r===null||!("nodeType"in r)?!1:r.nodeType===Node.ELEMENT_NODE}function rn(r,e){return e===void 0&&(e=document),typeof r=="string"?e.querySelector(r):tn(r)?r:null}function Ms(r){for(var e;r&&!r.dir;)r=r.parentNode;return(e=r)==null?void 0:e.dir}class js{constructor(e,t){this.uppy=e,this.opts=t??{}}getPluginState(){const{plugins:e}=this.uppy.getState();return(e==null?void 0:e[this.id])||{}}setPluginState(e){const{plugins:t}=this.uppy.getState();this.uppy.setState({plugins:{...t,[this.id]:{...t[this.id],...e}}})}setOptions(e){this.opts={...this.opts,...e},this.setPluginState(void 0),this.i18nInit()}i18nInit(){const e=new gs([this.defaultLocale,this.uppy.locale,this.opts.locale]);this.i18n=e.translate.bind(e),this.i18nArray=e.translateArray.bind(e),this.setPluginState(void 0)}addTarget(e){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")}install(){}uninstall(){}update(e){}afterUpdate(){}}function os(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var sn=0;function on(r){return"__private_"+sn+++"_"+r}function nn(r){let e=null,t;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return t=i,e||(e=Promise.resolve().then(()=>(e=null,r(...t)))),e}}var pt=on("updateUI");class Yt extends js{constructor(){super(...arguments),Object.defineProperty(this,pt,{writable:!0,value:void 0})}getTargetPlugin(e){let t;if(typeof(e==null?void 0:e.addTarget)=="function")t=e,t instanceof Yt||console.warn(new Error("The provided plugin is not an instance of UIPlugin. This is an indication of a bug with the way Uppy is bundled.",{cause:{targetPlugin:t,UIPlugin:Yt}}));else if(typeof e=="function"){const s=e;this.uppy.iteratePlugins(i=>{i instanceof s&&(t=i)})}return t}mount(e,t){const s=t.id,i=rn(e);if(i){this.isTargetDOMEl=!0;const a=document.createElement("div");return a.classList.add("uppy-Root"),os(this,pt)[pt]=nn(l=>{this.uppy.getPlugin(this.id)&&(is(this.render(l,a),a),this.afterUpdate())}),this.uppy.log(`Installing ${s} to a DOM element '${e}'`),this.opts.replaceTargetContent&&(i.innerHTML=""),is(this.render(this.uppy.getState(),a),a),this.el=a,i.appendChild(a),a.dir=this.opts.direction||Ms(a)||"ltr",this.onMount(),this.el}const o=this.getTargetPlugin(e);if(o)return this.uppy.log(`Installing ${s} to ${o.id}`),this.parent=o,this.el=o.addTarget(t),this.onMount(),this.el;this.uppy.log(`Not installing ${s}`);let n=`Invalid target option given to ${s}.`;throw typeof e=="function"?n+=" The given target is not a Plugin class. Please check that you're not specifying a React Component instead of a plugin. If you are using @uppy/* packages directly, make sure you have only 1 version of @uppy/core installed: run `npm ls @uppy/core` on the command line and verify that all the versions match and are deduped correctly.":n+="If you meant to target an HTML element, please make sure that the element exists. Check that the <script> tag initializing Uppy is right before the closing </body> tag at the end of the page. (see https://github.com/transloadit/uppy/issues/1042)\n\nIf you meant to target a plugin, please confirm that your `import` statements or `require` calls are correct.",new Error(n)}render(e,t){throw new Error("Extend the render method to add your plugin to a DOM element")}update(e){if(this.el!=null){var t,s;(t=(s=os(this,pt))[pt])==null||t.call(s,e)}}unmount(){if(this.isTargetDOMEl){var e;(e=this.el)==null||e.remove()}this.onUnmount()}onMount(){}onUnmount(){}}const Ns=Yt,Ls=Array.from;function an(){const r=document.body;return!(!("draggable"in r)||!("ondragstart"in r&&"ondrop"in r)||!("FormData"in window)||!("FileReader"in window))}function Is(r,e,t,s){let{onSuccess:i}=s;r.readEntries(o=>{const n=[...e,...o];o.length?queueMicrotask(()=>{Is(r,n,t,{onSuccess:i})}):i(n)},o=>{t(o),i(e)})}function Bs(r,e){return r==null?r:{kind:r.isFile?"file":r.isDirectory?"directory":void 0,name:r.name,getFile(){return new Promise((t,s)=>r.file(t,s))},async*values(){const t=r.createReader();yield*await new Promise(i=>{Is(t,[],e,{onSuccess:o=>i(o.map(n=>Bs(n,e)))})})},isSameEntry:void 0}}function zs(r,e,t){try{return t===void 0&&(t=void 0),async function*(){const s=()=>`${e}/${r.name}`;if(r.kind==="file"){const i=await r.getFile();i!=null?(i.relativePath=e?s():null,yield i):t!=null&&(yield t)}else if(r.kind==="directory")for await(const i of r.values())yield*zs(i,e?s():r.name);else t!=null&&(yield t)}()}catch(s){return Promise.reject(s)}}async function*ln(r,e){const t=await Promise.all(Array.from(r.items,async s=>{var i;let o;const n=()=>typeof s.getAsEntry=="function"?s.getAsEntry():s.webkitGetAsEntry();return(i=o)!=null||(o=Bs(n(),e)),{fileSystemHandle:o,lastResortFile:s.getAsFile()}}));for(const{lastResortFile:s,fileSystemHandle:i}of t)if(i!=null)try{yield*zs(i,"",s)}catch(o){s!=null?yield s:e(o)}else s!=null&&(yield s)}function un(r){const e=Ls(r.files);return Promise.resolve(e)}async function cn(r,e){var t;const s=(t=e==null?void 0:e.logDropError)!=null?t:Function.prototype;try{const i=[];for await(const o of ln(r,s))i.push(o);return i}catch{return un(r)}}const dn={strings:{dropHereOr:"Drop here or %{browse}",browse:"browse"}},pn={version:"4.0.2"},hn={inputName:"files[]",width:"100%",height:"100%"};class rr extends Ns{constructor(e,t){super(e,{...hn,...t}),this.isDragDropSupported=an(),this.addFiles=s=>{const i=s.map(o=>({source:this.id,name:o.name,type:o.type,data:o,meta:{relativePath:o.relativePath||null}}));try{this.uppy.addFiles(i)}catch(o){this.uppy.log(o)}},this.onInputChange=s=>{const i=Ls(s.target.files);i.length>0&&(this.uppy.log("[DragDrop] Files selected through input"),this.addFiles(i)),s.target.value=null},this.handleDragOver=s=>{var i,o;s.preventDefault(),s.stopPropagation();const{types:n}=s.dataTransfer,a=n.some(c=>c==="Files"),{allowNewUpload:l}=this.uppy.getState();if(!a||!l){s.dataTransfer.dropEffect="none";return}s.dataTransfer.dropEffect="copy",this.setPluginState({isDraggingOver:!0}),(i=(o=this.opts).onDragOver)==null||i.call(o,s)},this.handleDragLeave=s=>{var i,o;s.preventDefault(),s.stopPropagation(),this.setPluginState({isDraggingOver:!1}),(i=(o=this.opts).onDragLeave)==null||i.call(o,s)},this.handleDrop=async s=>{var i,o;s.preventDefault(),s.stopPropagation(),this.setPluginState({isDraggingOver:!1});const n=l=>{this.uppy.log(l,"error")},a=await cn(s.dataTransfer,{logDropError:n});a.length>0&&(this.uppy.log("[DragDrop] Files dropped"),this.addFiles(a)),(i=(o=this.opts).onDrop)==null||i.call(o,s)},this.type="acquirer",this.id=this.opts.id||"DragDrop",this.title="Drag & Drop",this.defaultLocale=dn,this.i18nInit()}renderHiddenFileInput(){var e;const{restrictions:t}=this.uppy.opts;return y("input",{className:"uppy-DragDrop-input",type:"file",hidden:!0,ref:s=>{this.fileInputRef=s},name:this.opts.inputName,multiple:t.maxNumberOfFiles!==1,accept:(e=t.allowedFileTypes)==null?void 0:e.join(", "),onChange:this.onInputChange})}static renderArrowSvg(){return y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16"},y("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0",fillRule:"evenodd"}))}renderLabel(){return y("div",{className:"uppy-DragDrop-label"},this.i18nArray("dropHereOr",{browse:y("span",{className:"uppy-DragDrop-browse"},this.i18n("browse"))}))}renderNote(){return y("span",{className:"uppy-DragDrop-note"},this.opts.note)}render(){const e=`uppy-u-reset
      uppy-DragDrop-container
      ${this.isDragDropSupported?"uppy-DragDrop--isDragDropSupported":""}
      ${this.getPluginState().isDraggingOver?"uppy-DragDrop--isDraggingOver":""}
    `,t={width:this.opts.width,height:this.opts.height};return y("button",{type:"button",className:e,style:t,onClick:()=>this.fileInputRef.click(),onDragOver:this.handleDragOver,onDragLeave:this.handleDragLeave,onDrop:this.handleDrop},this.renderHiddenFileInput(),y("div",{className:"uppy-DragDrop-inner"},rr.renderArrowSvg(),this.renderLabel(),this.renderNote()))}install(){const{target:e}=this.opts;this.setPluginState({isDraggingOver:!1}),e&&this.mount(e,this)}uninstall(){this.unmount()}}rr.VERSION=pn.version;function ns(r,e,t,s){return t===0||r===e?r:s===0?e:r+(e-r)*2**(-s/t)}const de={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete"};var Ds={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(r){(function(){var e={}.hasOwnProperty;function t(){for(var o="",n=0;n<arguments.length;n++){var a=arguments[n];a&&(o=i(o,s(a)))}return o}function s(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return t.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var n="";for(var a in o)e.call(o,a)&&o[a]&&(n=i(n,a));return n}function i(o,n){return n?o?o+" "+n:o+n:o}r.exports?(t.default=t,r.exports=t):window.classNames=t})()})(Ds);var fn=Ds.exports;const Qt=tt(fn);function pr(r){const e=[];let t="indeterminate",s;for(const{progress:o}of Object.values(r)){const{preprocess:n,postprocess:a}=o;s==null&&(n||a)&&({mode:t,message:s}=n||a),(n==null?void 0:n.mode)==="determinate"&&e.push(n.value),(a==null?void 0:a.mode)==="determinate"&&e.push(a.value)}const i=e.reduce((o,n)=>o+n/e.length,0);return{mode:t,message:s,value:i}}function mn(r){const e=Math.floor(r/3600)%24,t=Math.floor(r/60)%60,s=Math.floor(r%60);return{hours:e,minutes:t,seconds:s}}function gn(r){const e=mn(r),t=e.hours===0?"":`${e.hours}h`,s=e.minutes===0?"":`${e.hours===0?e.minutes:` ${e.minutes.toString(10).padStart(2,"0")}`}m`,i=e.hours!==0?"":`${e.minutes===0?e.seconds:` ${e.seconds.toString(10).padStart(2,"0")}`}s`;return`${t}${s}${i}`}const yn="·",as=()=>` ${yn} `;function vn(r){const{newFiles:e,isUploadStarted:t,recoveredState:s,i18n:i,uploadState:o,isSomeGhost:n,startUpload:a}=r,l=Qt("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":o===de.STATE_WAITING},{"uppy-StatusBar-actionBtn--disabled":n}),c=e&&t&&!s?i("uploadXNewFiles",{smart_count:e}):i("uploadXFiles",{smart_count:e});return y("button",{type:"button",className:l,"aria-label":i("uploadXFiles",{smart_count:e}),onClick:a,disabled:n,"data-uppy-super-focusable":!0},c)}function _n(r){const{i18n:e,uppy:t}=r;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":e("retryUpload"),onClick:()=>t.retryAll().catch(()=>{}),"data-uppy-super-focusable":!0,"data-cy":"retry"},y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"8",height:"10",viewBox:"0 0 8 10"},y("path",{d:"M4 2.408a2.75 2.75 0 1 0 2.75 2.75.626.626 0 0 1 1.25.018v.023a4 4 0 1 1-4-4.041V.25a.25.25 0 0 1 .389-.208l2.299 1.533a.25.25 0 0 1 0 .416l-2.3 1.533A.25.25 0 0 1 4 3.316v-.908z"})),e("retry"))}function bn(r){const{i18n:e,uppy:t}=r;return y("button",{type:"button",className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:e("cancel"),"aria-label":e("cancel"),onClick:()=>t.cancelAll(),"data-cy":"cancel","data-uppy-super-focusable":!0},y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},y("g",{fill:"none",fillRule:"evenodd"},y("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),y("path",{fill:"#FFF",d:"M9.283 8l2.567 2.567-1.283 1.283L8 9.283 5.433 11.85 4.15 10.567 6.717 8 4.15 5.433 5.433 4.15 8 6.717l2.567-2.567 1.283 1.283z"}))))}function wn(r){const{isAllPaused:e,i18n:t,isAllComplete:s,resumableUploads:i,uppy:o}=r,n=t(e?"resume":"pause");function a(){if(!s){if(!i){o.cancelAll();return}if(e){o.resumeAll();return}o.pauseAll()}}return y("button",{title:n,"aria-label":n,className:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onClick:a,"data-cy":"togglePauseResume","data-uppy-super-focusable":!0},y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-c-icon",width:"16",height:"16",viewBox:"0 0 16 16"},y("g",{fill:"none",fillRule:"evenodd"},y("circle",{fill:"#888",cx:"8",cy:"8",r:"8"}),y("path",{fill:"#FFF",d:e?"M6 4.25L11.5 8 6 11.75z":"M5 4.5h2v7H5v-7zm4 0h2v7H9v-7z"}))))}function Sn(r){const{i18n:e,doneButtonHandler:t}=r;return y("button",{type:"button",className:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--done",onClick:t,"data-uppy-super-focusable":!0},e("done"))}function qs(){return y("svg",{className:"uppy-StatusBar-spinner","aria-hidden":"true",focusable:"false",width:"14",height:"14"},y("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0",fillRule:"evenodd"}))}function Pn(r){const{progress:e}=r,{value:t,mode:s,message:i}=e,o="·";return y("div",{className:"uppy-StatusBar-content"},y(qs,null),s==="determinate"?`${Math.round(t*100)}% ${o} `:"",i)}function Tn(r){const{numUploads:e,complete:t,totalUploadedSize:s,totalSize:i,totalETA:o,i18n:n}=r,a=e>1;return y("div",{className:"uppy-StatusBar-statusSecondary"},a&&n("filesUploadedOfTotal",{complete:t,smart_count:e}),y("span",{className:"uppy-StatusBar-additionalInfo"},a&&as(),n("dataUploadedOfTotal",{complete:Ze(s),total:Ze(i)}),as(),n("xTimeLeft",{time:gn(o)})))}function Hs(r){const{i18n:e,complete:t,numUploads:s}=r;return y("div",{className:"uppy-StatusBar-statusSecondary"},e("filesUploadedOfTotal",{complete:t,smart_count:s}))}function Fn(r){const{i18n:e,newFiles:t,startUpload:s}=r,i=Qt("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--uploadNewlyAdded");return y("div",{className:"uppy-StatusBar-statusSecondary"},y("div",{className:"uppy-StatusBar-statusSecondaryHint"},e("xMoreFilesAdded",{smart_count:t})),y("button",{type:"button",className:i,"aria-label":e("uploadXFiles",{smart_count:t}),onClick:s},e("upload")))}function Un(r){const{i18n:e,supportsUploadProgress:t,totalProgress:s,showProgressDetails:i,isUploadStarted:o,isAllComplete:n,isAllPaused:a,newFiles:l,numUploads:c,complete:d,totalUploadedSize:u,totalSize:h,totalETA:p,startUpload:f}=r,_=l&&o;if(!o||n)return null;const b=e(a?"paused":"uploading");function v(){return!a&&!_&&i?t?y(Tn,{numUploads:c,complete:d,totalUploadedSize:u,totalSize:h,totalETA:p,i18n:e}):y(Hs,{i18n:e,complete:d,numUploads:c}):null}return y("div",{className:"uppy-StatusBar-content","aria-label":b,title:b},a?null:y(qs,null),y("div",{className:"uppy-StatusBar-status"},y("div",{className:"uppy-StatusBar-statusPrimary"},t?`${b}: ${s}%`:b),v(),_?y(Fn,{i18n:e,newFiles:l,startUpload:f}):null))}function En(r){const{i18n:e}=r;return y("div",{className:"uppy-StatusBar-content",role:"status",title:e("complete")},y("div",{className:"uppy-StatusBar-status"},y("div",{className:"uppy-StatusBar-statusPrimary"},y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"15",height:"11",viewBox:"0 0 15 11"},y("path",{d:"M.414 5.843L1.627 4.63l3.472 3.472L13.202 0l1.212 1.213L5.1 10.528z"})),e("complete"))))}function On(r){const{error:e,i18n:t,complete:s,numUploads:i}=r;function o(){const n=`${t("uploadFailed")} 

 ${e}`;alert(n)}return y("div",{className:"uppy-StatusBar-content",title:t("uploadFailed")},y("svg",{"aria-hidden":"true",focusable:"false",className:"uppy-StatusBar-statusIndicator uppy-c-icon",width:"11",height:"11",viewBox:"0 0 11 11"},y("path",{d:"M4.278 5.5L0 1.222 1.222 0 5.5 4.278 9.778 0 11 1.222 6.722 5.5 11 9.778 9.778 11 5.5 6.722 1.222 11 0 9.778z"})),y("div",{className:"uppy-StatusBar-status"},y("div",{className:"uppy-StatusBar-statusPrimary"},t("uploadFailed"),y("button",{className:"uppy-u-reset uppy-StatusBar-details","aria-label":t("showErrorDetails"),"data-microtip-position":"top-right","data-microtip-size":"medium",onClick:o,type:"button"},"?")),y(Hs,{i18n:t,complete:s,numUploads:i})))}const{STATE_ERROR:ls,STATE_WAITING:An,STATE_PREPROCESSING:hr,STATE_UPLOADING:qt,STATE_POSTPROCESSING:fr,STATE_COMPLETE:Ht}=de;function Cn(r){let{newFiles:e,allowNewUpload:t,isUploadInProgress:s,isAllPaused:i,resumableUploads:o,error:n,hideUploadButton:a=void 0,hidePauseResumeButton:l=!1,hideCancelButton:c=!1,hideRetryButton:d=!1,recoveredState:u,uploadState:h,totalProgress:p,files:f,supportsUploadProgress:_,hideAfterFinish:b=!1,isSomeGhost:v,doneButtonHandler:T=void 0,isUploadStarted:R,i18n:E,startUpload:x,uppy:U,isAllComplete:F,showProgressDetails:O=void 0,numUploads:j,complete:M,totalSize:Fe,totalETA:or,totalUploadedSize:st}=r;function Ee(){switch(h){case fr:case hr:{const Lt=pr(f);return Lt.mode==="determinate"?Lt.value*100:p}case ls:return null;case qt:return _?p:null;default:return p}}function Nt(){switch(h){case fr:case hr:{const{mode:Lt}=pr(f);return Lt==="indeterminate"}case qt:return!_;default:return!1}}const Ye=Ee(),Oe=Ye??100,Ae=!n&&e&&(!s&&!i||u)&&t&&!a,pe=!c&&h!==An&&h!==Ht,Ce=o&&!l&&h===qt,Dr=n&&!F&&!d,qr=T&&h===Ht,ei=Qt("uppy-StatusBar-progress",{"is-indeterminate":Nt()}),ti=Qt("uppy-StatusBar",`is-${h}`,{"has-ghosts":v}),Hr=(()=>{switch(h){case hr:case fr:return y(Pn,{progress:pr(f)});case Ht:return y(En,{i18n:E});case ls:return y(On,{error:n,i18n:E,numUploads:j,complete:M});case qt:return y(Un,{i18n:E,supportsUploadProgress:_,totalProgress:p,showProgressDetails:O,isUploadStarted:R,isAllComplete:F,isAllPaused:i,newFiles:e,numUploads:j,complete:M,totalUploadedSize:st,totalSize:Fe,totalETA:or,startUpload:x});default:return null}})();return y("div",{className:ti,"aria-hidden":!(Ae||Dr||Ce||pe||qr)&&!Hr||h===Ht&&b},y("div",{className:ei,style:{width:`${Oe}%`},role:"progressbar","aria-label":`${Oe}%`,"aria-valuetext":`${Oe}%`,"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":Ye}),Hr,y("div",{className:"uppy-StatusBar-actions"},Ae?y(vn,{newFiles:e,isUploadStarted:R,recoveredState:u,i18n:E,isSomeGhost:v,startUpload:x,uploadState:h}):null,Dr?y(_n,{i18n:E,uppy:U}):null,Ce?y(wn,{isAllPaused:i,i18n:E,isAllComplete:F,resumableUploads:o,uppy:U}):null,pe?y(bn,{i18n:E,uppy:U}):null,qr?y(Sn,{i18n:E,doneButtonHandler:T}):null))}const $n={strings:{uploading:"Uploading",complete:"Complete",uploadFailed:"Upload failed",paused:"Paused",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",done:"Done",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},upload:"Upload",retryUpload:"Retry upload",xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"},showErrorDetails:"Show error details"}};function $(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var Rn=0;function rt(r){return"__private_"+Rn+++"_"+r}const xn={version:"4.0.3"},kn=2e3,Mn=2e3;function jn(r,e,t,s){if(r)return de.STATE_ERROR;if(e)return de.STATE_COMPLETE;if(t)return de.STATE_WAITING;let i=de.STATE_WAITING;const o=Object.keys(s);for(let n=0;n<o.length;n++){const{progress:a}=s[o[n]];if(a.uploadStarted&&!a.uploadComplete)return de.STATE_UPLOADING;a.preprocess&&(i=de.STATE_PREPROCESSING),a.postprocess&&i!==de.STATE_PREPROCESSING&&(i=de.STATE_POSTPROCESSING)}return i}const Nn={hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,hideAfterFinish:!0,doneButtonHandler:null};var ne=rt("lastUpdateTime"),ue=rt("previousUploadedBytes"),we=rt("previousSpeed"),te=rt("previousETA"),mr=rt("computeSmoothETA"),ht=rt("onUploadStart");class Ws extends Ns{constructor(e,t){super(e,{...Nn,...t}),Object.defineProperty(this,mr,{value:Ln}),Object.defineProperty(this,ne,{writable:!0,value:void 0}),Object.defineProperty(this,ue,{writable:!0,value:void 0}),Object.defineProperty(this,we,{writable:!0,value:void 0}),Object.defineProperty(this,te,{writable:!0,value:void 0}),this.startUpload=()=>this.uppy.upload().catch(()=>{}),Object.defineProperty(this,ht,{writable:!0,value:()=>{const{recoveredState:s}=this.uppy.getState();if($(this,we)[we]=null,$(this,te)[te]=null,s){$(this,ue)[ue]=Object.values(s.files).reduce((i,o)=>{let{progress:n}=o;return i+n.bytesUploaded},0),this.uppy.emit("restore-confirmed");return}$(this,ne)[ne]=performance.now(),$(this,ue)[ue]=0}}),this.id=this.opts.id||"StatusBar",this.title="StatusBar",this.type="progressindicator",this.defaultLocale=$n,this.i18nInit(),this.render=this.render.bind(this),this.install=this.install.bind(this)}render(e){const{capabilities:t,files:s,allowNewUpload:i,totalProgress:o,error:n,recoveredState:a}=e,{newFiles:l,startedFiles:c,completeFiles:d,isUploadStarted:u,isAllComplete:h,isAllPaused:p,isUploadInProgress:f,isSomeGhost:_}=this.uppy.getObjectOfFilesPerState(),b=a?Object.values(s):l,v=!!t.resumableUploads,T=t.uploadProgress!==!1;let R=0,E=0;c.forEach(U=>{R+=U.progress.bytesTotal||0,E+=U.progress.bytesUploaded||0});const x=$(this,mr)[mr]({uploaded:E,total:R,remaining:R-E});return Cn({error:n,uploadState:jn(n,h,a,e.files||{}),allowNewUpload:i,totalProgress:o,totalSize:R,totalUploadedSize:E,isAllComplete:!1,isAllPaused:p,isUploadStarted:u,isUploadInProgress:f,isSomeGhost:_,recoveredState:a,complete:d.length,newFiles:b.length,numUploads:c.length,totalETA:x,files:s,i18n:this.i18n,uppy:this.uppy,startUpload:this.startUpload,doneButtonHandler:this.opts.doneButtonHandler,resumableUploads:v,supportsUploadProgress:T,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish})}onMount(){const e=this.el;Ms(e)||(e.dir="ltr")}install(){const{target:e}=this.opts;e&&this.mount(e,this),this.uppy.on("upload",$(this,ht)[ht]),$(this,ne)[ne]=performance.now(),$(this,ue)[ue]=this.uppy.getFiles().reduce((t,s)=>t+s.progress.bytesUploaded,0)}uninstall(){this.unmount(),this.uppy.off("upload",$(this,ht)[ht])}}function Ln(r){var e,t;if(r.total===0||r.remaining===0)return 0;(t=(e=$(this,ne))[ne])!=null||(e[ne]=performance.now());const s=performance.now()-$(this,ne)[ne];if(s===0){var i;return Math.round(((i=$(this,te)[te])!=null?i:0)/100)/10}const o=r.uploaded-$(this,ue)[ue];if($(this,ue)[ue]=r.uploaded,o<=0){var n;return Math.round(((n=$(this,te)[te])!=null?n:0)/100)/10}const a=o/s,l=$(this,we)[we]==null?a:ns(a,$(this,we)[we],kn,s);$(this,we)[we]=l;const c=r.remaining/l,d=Math.max($(this,te)[te]-s,0),u=$(this,te)[te]==null?c:ns(c,d,Mn,s);return $(this,te)[te]=u,$(this,ne)[ne]=performance.now(),Math.round(u/100)/10}Ws.VERSION=xn.version;class In extends Error{constructor(){super(...arguments),this.name="UserFacingApiError"}}var Gs={};function ae(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Bn=ae;ae.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};ae.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};ae.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},t),this._options.unref&&this._timer.unref(),!0};ae.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};ae.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};ae.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};ae.prototype.start=ae.prototype.try;ae.prototype.errors=function(){return this._errors};ae.prototype.attempts=function(){return this._attempts};ae.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,s=0;s<this._errors.length;s++){var i=this._errors[s],o=i.message,n=(r[o]||0)+1;r[o]=n,n>=t&&(e=i,t=n)}return e};(function(r){var e=Bn;r.operation=function(t){var s=r.timeouts(t);return new e(s,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},r.timeouts=function(t){if(t instanceof Array)return[].concat(t);var s={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var i in t)s[i]=t[i];if(s.minTimeout>s.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var o=[],n=0;n<s.retries;n++)o.push(this.createTimeout(n,s));return t&&t.forever&&!o.length&&o.push(this.createTimeout(n,s)),o.sort(function(a,l){return a-l}),o},r.createTimeout=function(t,s){var i=s.randomize?Math.random()+1:1,o=Math.round(i*Math.max(s.minTimeout,1)*Math.pow(s.factor,t));return o=Math.min(o,s.maxTimeout),o},r.wrap=function(t,s,i){if(s instanceof Array&&(i=s,s=null),!i){i=[];for(var o in t)typeof t[o]=="function"&&i.push(o)}for(var n=0;n<i.length;n++){var a=i[n],l=t[a];t[a]=(function(d){var u=r.operation(s),h=Array.prototype.slice.call(arguments,1),p=h.pop();h.push(function(f){u.retry(f)||(f&&(arguments[0]=u.mainError()),p.apply(this,arguments))}),u.attempt(function(){d.apply(t,h)})}).bind(t,l),t[a].options=s}}})(Gs);var zn=Gs;const Dn=tt(zn),qn=Object.prototype.toString,Hn=r=>qn.call(r)==="[object Error]",Wn=new Set(["network error","Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Load failed","Network request failed","fetch failed","terminated"]);function Gn(r){return r&&Hn(r)&&r.name==="TypeError"&&typeof r.message=="string"?r.message==="Load failed"?r.stack===void 0:Wn.has(r.message):!1}class Rr extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const us=(r,e,t)=>{const s=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=s,r};async function Ks(r,e){return new Promise((t,s)=>{e={onFailedAttempt(){},retries:10,shouldRetry:()=>!0,...e};const i=Dn.operation(e),o=()=>{var a;i.stop(),s((a=e.signal)==null?void 0:a.reason)};e.signal&&!e.signal.aborted&&e.signal.addEventListener("abort",o,{once:!0});const n=()=>{var a;(a=e.signal)==null||a.removeEventListener("abort",o),i.stop()};i.attempt(async a=>{try{const l=await r(a);n(),t(l)}catch(l){try{if(!(l instanceof Error))throw new TypeError(`Non-error was thrown: "${l}". You should only throw errors.`);if(l instanceof Rr)throw l.originalError;if(l instanceof TypeError&&!Gn(l))throw l;if(us(l,a,e),await e.shouldRetry(l)||(i.stop(),s(l)),await e.onFailedAttempt(l),!i.retry(l))throw i.mainError()}catch(c){us(c,a,e),n(),s(c)}}})})}class Kn extends Error{constructor(e,t){t===void 0&&(t=null),super("This looks like a network error, the endpoint might be blocked by an internet provider or a firewall."),this.cause=e,this.isNetworkError=!0,this.request=t}}function Xn(){return fetch(...arguments).catch(r=>{throw r.name==="AbortError"?r:new Kn(r)})}function Xs(r,e){return Object.prototype.hasOwnProperty.call(r,e)}class Vn extends Error{constructor(e,t){super(e),this.cause=t==null?void 0:t.cause,this.cause&&Xs(this.cause,"isNetworkError")?this.isNetworkError=this.cause.isNetworkError:this.isNetworkError=!1}}function Jn(r,e,t){const{progress:s,bytesUploaded:i,bytesTotal:o}=e;if(s){var n;r.uppy.log(`Upload progress: ${s}`),r.uppy.emit("upload-progress",t,{uploadStarted:(n=t.progress.uploadStarted)!=null?n:0,bytesUploaded:i,bytesTotal:o})}}const Yn=bs(Jn,300,{leading:!0,trailing:!0});function Qn(r){var e;const s=(e=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/i.exec(r))==null?void 0:e[1];return`${/^http:\/\//i.test(r)?"ws":"wss"}://${s}`}class Zn extends Error{constructor(){super("Authorization required"),this.name="AuthError",this.isAuthError=!0}}function ge(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var ea=0;function sr(r){return"__private_"+ea+++"_"+r}const ta={version:"4.1.0"};function ra(r){return r.replace(/\/$/,"")}const Vs=10,sa=5*60*1e3,ia=401;class oa extends Error{constructor(e){let{statusCode:t,message:s}=e;super(s),this.name="HttpError",this.statusCode=t}}async function na(r){if(r.status===ia)throw new Zn;if(r.ok)return r.json();let e=`Failed request with status: ${r.status}. ${r.statusText}`,t;try{t=await r.json(),t.message&&(e=`${e} message: ${t.message}`),t.requestId&&(e=`${e} request-Id: ${t.requestId}`)}catch(s){throw new Error(e,{cause:s})}throw r.status>=400&&r.status<=499&&t.message?new In(t.message):new oa({statusCode:r.status,message:e})}var ye=sr("companionHeaders"),ft=sr("getUrl"),gr=sr("requestSocketToken"),mt=sr("awaitRemoteFileUpload");class Js{constructor(e,t){Object.defineProperty(this,mt,{value:la}),Object.defineProperty(this,ft,{value:aa}),Object.defineProperty(this,ye,{writable:!0,value:void 0}),Object.defineProperty(this,gr,{writable:!0,value:async s=>{var i;let{file:o,postBody:n,signal:a}=s;if(((i=o.remote)==null?void 0:i.url)==null)throw new Error("Cannot connect to an undefined URL");return(await this.post(o.remote.url,{...o.remote.body,...n},{signal:a})).token}}),this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),ge(this,ye)[ye]=t.companionHeaders}setCompanionHeaders(e){ge(this,ye)[ye]=e}[Symbol.for("uppy test: getCompanionHeaders")](){return ge(this,ye)[ye]}get hostname(){const{companion:e}=this.uppy.getState(),t=this.opts.companionUrl;return ra(e&&e[t]?e[t]:t)}async headers(e){return e===void 0&&(e=!1),{...{Accept:"application/json",...e?void 0:{"Content-Type":"application/json"}},...ge(this,ye)[ye]}}onReceiveResponse(e){const{headers:t}=e,i=this.uppy.getState().companion||{},o=this.opts.companionUrl;t.has("i-am")&&t.get("i-am")!==i[o]&&this.uppy.setState({companion:{...i,[o]:t.get("i-am")}})}async request(e){let{path:t,method:s="GET",data:i,skipPostResponse:o,signal:n}=e;try{const a=await this.headers(!i),l=await Xn(ge(this,ft)[ft](t),{method:s,signal:n,headers:a,credentials:this.opts.companionCookiesRule||"same-origin",body:i?JSON.stringify(i):null});return o||this.onReceiveResponse(l),await na(l)}catch(a){throw a.isAuthError||a.name==="UserFacingApiError"||a.name==="AbortError"?a:new Vn(`Could not ${s} ${ge(this,ft)[ft](t)}`,{cause:a})}}async get(e,t){return this.request({...t,path:e})}async post(e,t,s){return this.request({...s,path:e,method:"POST",data:t})}async delete(e,t,s){return this.request({...s,path:e,method:"DELETE",data:t})}async uploadRemoteFile(e,t,s){var i=this;try{const{signal:o,getQueue:n}=s||{};return await Ks(async()=>{var a;const l=(a=this.uppy.getFile(e.id))==null?void 0:a.serverToken;if(l!=null)return this.uppy.log(`Connecting to exiting websocket ${l}`),ge(this,mt)[mt]({file:e,queue:n(),signal:o});const d=await n().wrapPromiseFunction(async function(){try{return await ge(i,gr)[gr](...arguments)}catch(u){if(u.isAuthError)throw new Rr(u);if(u.cause==null)throw u;const h=u.cause,p=()=>[408,409,429,418,423].includes(h.statusCode)||h.statusCode>=500&&h.statusCode<=599&&![501,505].includes(h.statusCode);throw h.name==="HttpError"&&!p()?new Rr(h):h}},{priority:-1})({file:e,postBody:t,signal:o}).abortOn(o);if(this.uppy.getFile(e.id))return this.uppy.setFileState(e.id,{serverToken:d}),ge(this,mt)[mt]({file:this.uppy.getFile(e.id),queue:n(),signal:o})},{retries:Vs,signal:o,onFailedAttempt:a=>this.uppy.log(`Retrying upload due to: ${a.message}`,"warning")})}catch(o){if(o.name==="AbortError")return;throw this.uppy.emit("upload-error",e,o),o}}}function aa(r){return/^(https?:|)\/\//.test(r)?r:`${this.hostname}/${r}`}async function la(r){let{file:e,queue:t,signal:s}=r,i;const{capabilities:o}=this.uppy.getState();try{return await new Promise((n,a)=>{const l=e.serverToken,c=Qn(e.remote.companionUrl);let d,u,h,{isPaused:p}=e;const f=(F,O)=>{if(d==null||d.readyState!==d.OPEN){var j;this.uppy.log(`Cannot send "${F}" to socket ${e.id} because the socket state was ${String((j=d)==null?void 0:j.readyState)}`,"warning");return}d.send(JSON.stringify({action:F,payload:O??{}}))};function _(){o.resumableUploads&&f(p?"pause":"resume")}const b=async()=>{u&&u.abort(),u=new AbortController;const F=j=>{var M;this.uppy.setFileState(e.id,{serverToken:null}),(M=u)==null||M.abort==null||M.abort(),a(j)};function O(){clearTimeout(h),!p&&(h=setTimeout(()=>F(new Error("Timeout waiting for message from Companion socket")),sa))}try{await t.wrapPromiseFunction(async()=>{await Ks(async()=>new Promise((M,Fe)=>{d=new WebSocket(`${c}/api/${l}`),O(),d.addEventListener("close",()=>{d=void 0,Fe(new Error("Socket closed unexpectedly"))}),d.addEventListener("error",st=>{var Ee;this.uppy.log(`Companion socket error ${JSON.stringify(st)}, closing socket`,"warning"),(Ee=d)==null||Ee.close()}),d.addEventListener("open",()=>{_()}),d.addEventListener("message",st=>{O();try{const{action:Ae,payload:pe}=JSON.parse(st.data);switch(Ae){case"progress":{Yn(this,pe,this.uppy.getFile(e.id));break}case"success":{var Ee,Nt,Ye,Oe;const Ce=(Ee=pe.response)==null?void 0:Ee.responseText;this.uppy.emit("upload-success",this.uppy.getFile(e.id),{uploadURL:pe.url,status:(Nt=(Ye=pe.response)==null?void 0:Ye.status)!=null?Nt:200,body:Ce?JSON.parse(Ce):void 0}),(Oe=u)==null||Oe.abort==null||Oe.abort(),n();break}case"error":{const{message:Ce}=pe.error;throw Object.assign(new Error(Ce),{cause:pe.error})}default:this.uppy.log(`Companion socket unknown action ${Ae}`,"warning")}}catch(Ae){F(Ae)}});const or=()=>{this.uppy.log(`Closing socket ${e.id}`,"info"),clearTimeout(h),d&&d.close(),d=void 0};u.signal.addEventListener("abort",()=>{or()})}),{retries:Vs,signal:u.signal,onFailedAttempt:()=>{u.signal.aborted||this.uppy.log(`Retrying websocket ${e.id}`,"info")}})})().abortOn(u.signal)}catch(j){if(u.signal.aborted)return;F(j)}},v=F=>{o.resumableUploads&&(p=F,d&&_())},T=F=>{var O;o.individualCancellation&&F.id===e.id&&(f("cancel"),(O=u)==null||O.abort==null||O.abort(),this.uppy.log(`upload ${e.id} was removed`,"info"),n())},R=()=>{var F;f("cancel"),(F=u)==null||F.abort==null||F.abort(),this.uppy.log(`upload ${e.id} was canceled`,"info"),n()},E=(F,O)=>{(F==null?void 0:F.id)===e.id&&v(O)},x=()=>v(!0),U=()=>v(!1);this.uppy.on("file-removed",T),this.uppy.on("cancel-all",R),this.uppy.on("upload-pause",E),this.uppy.on("pause-all",x),this.uppy.on("resume-all",U),i=()=>{this.uppy.off("file-removed",T),this.uppy.off("cancel-all",R),this.uppy.off("upload-pause",E),this.uppy.off("pause-all",x),this.uppy.off("resume-all",U)},s.addEventListener("abort",()=>{var F;(F=u)==null||F.abort()}),b()})}finally{i==null||i()}}Js.VERSION=ta.version;function ve(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var ua=0;function Ys(r){return"__private_"+ua+++"_"+r}var W=Ys("uppy"),gt=Ys("events");class ca{constructor(e){Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,gt,{writable:!0,value:[]}),ve(this,W)[W]=e}on(e,t){return ve(this,gt)[gt].push([e,t]),ve(this,W)[W].on(e,t)}remove(){for(const[e,t]of ve(this,gt)[gt].splice(0))ve(this,W)[W].off(e,t)}onFilePause(e,t){this.on("upload-pause",(s,i)=>{e===(s==null?void 0:s.id)&&t(i)})}onFileRemove(e,t){this.on("file-removed",s=>{e===s.id&&t(s.id)})}onPause(e,t){this.on("upload-pause",(s,i)=>{e===(s==null?void 0:s.id)&&t(i)})}onRetry(e,t){this.on("upload-retry",s=>{e===(s==null?void 0:s.id)&&t()})}onRetryAll(e,t){this.on("retry-all",()=>{ve(this,W)[W].getFile(e)&&t()})}onPauseAll(e,t){this.on("pause-all",()=>{ve(this,W)[W].getFile(e)&&t()})}onCancelAll(e,t){var s=this;this.on("cancel-all",function(){ve(s,W)[W].getFile(e)&&t(...arguments)})}onResumeAll(e,t){this.on("resume-all",()=>{ve(this,W)[W].getFile(e)&&t()})}}function S(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var da=0;function Q(r){return"__private_"+da+++"_"+r}function pa(r){return new Error("Cancelled",{cause:r})}function cs(r){if(r!=null){var e;const t=()=>this.abort(r.reason);r.addEventListener("abort",t,{once:!0});const s=()=>{r.removeEventListener("abort",t)};(e=this.then)==null||e.call(this,s,s)}return this}var re=Q("activeRequests"),J=Q("queuedHandlers"),ee=Q("paused"),$e=Q("pauseTimer"),G=Q("downLimit"),Re=Q("upperLimit"),_e=Q("rateLimitingTimer"),$t=Q("call"),Te=Q("queueNext"),xr=Q("next"),yr=Q("queue"),kr=Q("dequeue"),vr=Q("resume"),xe=Q("increaseLimit");class ha{constructor(e){Object.defineProperty(this,kr,{value:va}),Object.defineProperty(this,yr,{value:ya}),Object.defineProperty(this,xr,{value:ga}),Object.defineProperty(this,Te,{value:ma}),Object.defineProperty(this,$t,{value:fa}),Object.defineProperty(this,re,{writable:!0,value:0}),Object.defineProperty(this,J,{writable:!0,value:[]}),Object.defineProperty(this,ee,{writable:!0,value:!1}),Object.defineProperty(this,$e,{writable:!0,value:void 0}),Object.defineProperty(this,G,{writable:!0,value:1}),Object.defineProperty(this,Re,{writable:!0,value:void 0}),Object.defineProperty(this,_e,{writable:!0,value:void 0}),Object.defineProperty(this,vr,{writable:!0,value:()=>this.resume()}),Object.defineProperty(this,xe,{writable:!0,value:()=>{if(S(this,ee)[ee]){S(this,_e)[_e]=setTimeout(S(this,xe)[xe],0);return}S(this,G)[G]=this.limit,this.limit=Math.ceil((S(this,Re)[Re]+S(this,G)[G])/2);for(let t=S(this,G)[G];t<=this.limit;t++)S(this,Te)[Te]();S(this,Re)[Re]-S(this,G)[G]>3?S(this,_e)[_e]=setTimeout(S(this,xe)[xe],2e3):S(this,G)[G]=Math.floor(S(this,G)[G]/2)}}),typeof e!="number"||e===0?this.limit=1/0:this.limit=e}run(e,t){return!S(this,ee)[ee]&&S(this,re)[re]<this.limit?S(this,$t)[$t](e):S(this,yr)[yr](e,t)}wrapSyncFunction(e,t){var s=this;return function(){for(var i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];const a=s.run(()=>(e(...o),queueMicrotask(()=>a.done()),()=>{}),t);return{abortOn:cs,abort(){a.abort()}}}}wrapPromiseFunction(e,t){var s=this;return function(){for(var i=arguments.length,o=new Array(i),n=0;n<i;n++)o[n]=arguments[n];let a;const l=new Promise((c,d)=>{a=s.run(()=>{let u,h;try{h=Promise.resolve(e(...o))}catch(p){h=Promise.reject(p)}return h.then(p=>{u?d(u):(a.done(),c(p))},p=>{u?d(u):(a.done(),d(p))}),p=>{u=pa(p)}},t)});return l.abort=c=>{a.abort(c)},l.abortOn=cs,l}}resume(){S(this,ee)[ee]=!1,clearTimeout(S(this,$e)[$e]);for(let e=0;e<this.limit;e++)S(this,Te)[Te]()}pause(e){e===void 0&&(e=null),S(this,ee)[ee]=!0,clearTimeout(S(this,$e)[$e]),e!=null&&(S(this,$e)[$e]=setTimeout(S(this,vr)[vr],e))}rateLimit(e){clearTimeout(S(this,_e)[_e]),this.pause(e),this.limit>1&&Number.isFinite(this.limit)&&(S(this,Re)[Re]=this.limit-1,this.limit=S(this,G)[G],S(this,_e)[_e]=setTimeout(S(this,xe)[xe],e))}get isPaused(){return S(this,ee)[ee]}}function fa(r){S(this,re)[re]+=1;let e=!1,t;try{t=r()}catch(s){throw S(this,re)[re]-=1,s}return{abort:s=>{e||(e=!0,S(this,re)[re]-=1,t==null||t(s),S(this,Te)[Te]())},done:()=>{e||(e=!0,S(this,re)[re]-=1,S(this,Te)[Te]())}}}function ma(){queueMicrotask(()=>S(this,xr)[xr]())}function ga(){if(S(this,ee)[ee]||S(this,re)[re]>=this.limit||S(this,J)[J].length===0)return;const r=S(this,J)[J].shift();if(r==null)throw new Error("Invariant violation: next is null");const e=S(this,$t)[$t](r.fn);r.abort=e.abort,r.done=e.done}function ya(r,e){const t={fn:r,priority:(e==null?void 0:e.priority)||0,abort:()=>{S(this,kr)[kr](t)},done:()=>{throw new Error("Cannot mark a queued request as done: this indicates a bug")}},s=S(this,J)[J].findIndex(i=>t.priority>i.priority);return s===-1?S(this,J)[J].push(t):S(this,J)[J].splice(s,0,t),t}function va(r){const e=S(this,J)[J].indexOf(r);e!==-1&&S(this,J)[J].splice(e,1)}function _a(r){const e=t=>"error"in t&&!!t.error;return r.filter(t=>!e(t))}function ba(r){return r.filter(e=>{var t;return!((t=e.progress)!=null&&t.uploadStarted)||!e.isRestored})}const{AbortController:_r}=globalThis,Qs=function(r,e){r===void 0&&(r="Aborted");const t=new DOMException(r,"AbortError");return e!=null&&Xs(e,"cause")&&Object.defineProperty(t,"cause",{__proto__:null,configurable:!0,writable:!0,value:e.cause}),t};function ds(r,e){return r===!0?Object.keys(e):Array.isArray(r)?r:[]}function g(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var wa=0;function L(r){return"__private_"+wa+++"_"+r}const Sa=1024*1024,ps={getChunkSize(r){return Math.ceil(r.size/1e4)},onProgress(){},onPartComplete(){},onSuccess(){},onError(r){throw r}};function Pa(r){if(typeof r=="string")return parseInt(r,10);if(typeof r=="number")return r;throw new TypeError("Expected a number")}const Vt=Symbol("pausing upload, not an actual error");var q=L("abortController"),N=L("chunks"),X=L("chunkState"),se=L("data"),oe=L("file"),Rt=L("uploadHasStarted"),yt=L("onError"),Je=L("onSuccess"),Se=L("shouldUseMultipart"),qe=L("isRestoring"),jt=L("onReject"),Ne=L("maxMultipartParts"),Ot=L("minPartSize"),br=L("initChunks"),wr=L("createUpload"),vt=L("resumeUpload"),At=L("onPartProgress"),Ct=L("onPartComplete"),Sr=L("abortUpload");class Ta{constructor(e,t){var s,i;Object.defineProperty(this,Sr,{value:Oa}),Object.defineProperty(this,vt,{value:Ea}),Object.defineProperty(this,wr,{value:Ua}),Object.defineProperty(this,br,{value:Fa}),Object.defineProperty(this,q,{writable:!0,value:new _r}),Object.defineProperty(this,N,{writable:!0,value:[]}),Object.defineProperty(this,X,{writable:!0,value:[]}),Object.defineProperty(this,se,{writable:!0,value:void 0}),Object.defineProperty(this,oe,{writable:!0,value:void 0}),Object.defineProperty(this,Rt,{writable:!0,value:!1}),Object.defineProperty(this,yt,{writable:!0,value:void 0}),Object.defineProperty(this,Je,{writable:!0,value:void 0}),Object.defineProperty(this,Se,{writable:!0,value:void 0}),Object.defineProperty(this,qe,{writable:!0,value:void 0}),Object.defineProperty(this,jt,{writable:!0,value:o=>(o==null?void 0:o.cause)===Vt?null:g(this,yt)[yt](o)}),Object.defineProperty(this,Ne,{writable:!0,value:1e4}),Object.defineProperty(this,Ot,{writable:!0,value:5*Sa}),Object.defineProperty(this,At,{writable:!0,value:o=>n=>{if(!n.lengthComputable)return;g(this,X)[X][o].uploaded=Pa(n.loaded);const a=g(this,X)[X].reduce((l,c)=>l+c.uploaded,0);this.options.onProgress(a,g(this,se)[se].size)}}),Object.defineProperty(this,Ct,{writable:!0,value:o=>n=>{g(this,N)[N][o]=null,g(this,X)[X][o].etag=n,g(this,X)[X][o].done=!0;const a={PartNumber:o+1,ETag:n};this.options.onPartComplete(a)}}),this.options={...ps,...t},(i=(s=this.options).getChunkSize)!=null||(s.getChunkSize=ps.getChunkSize),g(this,se)[se]=e,g(this,oe)[oe]=t.file,g(this,Je)[Je]=this.options.onSuccess,g(this,yt)[yt]=this.options.onError,g(this,Se)[Se]=this.options.shouldUseMultipart,g(this,qe)[qe]=t.uploadId&&t.key,g(this,br)[br]()}start(){g(this,Rt)[Rt]?(g(this,q)[q].signal.aborted||g(this,q)[q].abort(Vt),g(this,q)[q]=new _r,g(this,vt)[vt]()):g(this,qe)[qe]?(this.options.companionComm.restoreUploadFile(g(this,oe)[oe],{uploadId:this.options.uploadId,key:this.options.key}),g(this,vt)[vt]()):g(this,wr)[wr]()}pause(){g(this,q)[q].abort(Vt),g(this,q)[q]=new _r}abort(e){e!=null&&e.really?g(this,Sr)[Sr]():this.pause()}[Symbol.for("uppy test: getChunkState")](){return g(this,X)[X]}}function Fa(){const r=g(this,se)[se].size,e=typeof g(this,Se)[Se]=="function"?g(this,Se)[Se](g(this,oe)[oe]):!!g(this,Se)[Se];if(e&&r>g(this,Ot)[Ot]){let t=Math.max(this.options.getChunkSize(g(this,se)[se]),g(this,Ot)[Ot]),s=Math.floor(r/t);s>g(this,Ne)[Ne]&&(s=g(this,Ne)[Ne],t=r/g(this,Ne)[Ne]),g(this,N)[N]=Array(s);for(let i=0,o=0;i<r;i+=t,o++){const n=Math.min(r,i+t),a=()=>{const l=i;return g(this,se)[se].slice(l,n)};if(g(this,N)[N][o]={getData:a,onProgress:g(this,At)[At](o),onComplete:g(this,Ct)[Ct](o),shouldUseMultipart:e},g(this,qe)[qe]){const l=i+t>r?r-i:t;g(this,N)[N][o].setAsUploaded=()=>{g(this,N)[N][o]=null,g(this,X)[X][o].uploaded=l}}}}else g(this,N)[N]=[{getData:()=>g(this,se)[se],onProgress:g(this,At)[At](0),onComplete:g(this,Ct)[Ct](0),shouldUseMultipart:e}];g(this,X)[X]=g(this,N)[N].map(()=>({uploaded:0}))}function Ua(){this.options.companionComm.uploadFile(g(this,oe)[oe],g(this,N)[N],g(this,q)[q].signal).then(g(this,Je)[Je],g(this,jt)[jt]),g(this,Rt)[Rt]=!0}function Ea(){this.options.companionComm.resumeUploadFile(g(this,oe)[oe],g(this,N)[N],g(this,q)[q].signal).then(g(this,Je)[Je],g(this,jt)[jt])}function Oa(){g(this,q)[q].abort(),this.options.companionComm.abortFileUpload(g(this,oe)[oe]).catch(r=>this.options.log(r))}function H(r){if(r!=null&&r.aborted)throw Qs("The operation was aborted",{cause:r.reason})}function Aa(r){let{method:e="PUT",CanonicalUri:t="/",CanonicalQueryString:s="",SignedHeaders:i,HashedPayload:o}=r;const n=Object.keys(i).map(a=>a.toLowerCase()).sort();return[e,t,s,...n.map(a=>`${a}:${i[a]}`),"",n.join(";"),o].join(`
`)}const Br=new TextEncoder,zr={name:"HMAC",hash:"SHA-256"};async function Ca(r){const{subtle:e}=globalThis.crypto;return e.digest(zr.hash,Br.encode(r))}async function $a(r){const{subtle:e}=globalThis.crypto;return e.importKey("raw",typeof r=="string"?Br.encode(r):r,zr,!1,["sign"])}function hs(r){const e=new Uint8Array(r);let t="";for(let s=0;s<e.length;s++)t+=e[s].toString(16).padStart(2,"0");return t}async function _t(r,e){const{subtle:t}=globalThis.crypto;return t.sign(zr,await $a(r),Br.encode(e))}async function Ra(r){let{accountKey:e,accountSecret:t,sessionToken:s,bucketName:i,Key:o,Region:n,expires:a,uploadId:l,partNumber:c}=r;const d="s3",u=`${d}.${n}.amazonaws.com`,h=`/${i}/${encodeURI(o).replace(/[;?:@&=+$,#!'()*]/g,M=>`%${M.charCodeAt(0).toString(16).toUpperCase()}`)}`,p="UNSIGNED-PAYLOAD",f=new Date().toISOString().replace(/[-:]|\.\d+/g,""),_=f.slice(0,8),b=`${_}/${n}/${d}/aws4_request`,v=new URL(`https://${u}${h}`);v.searchParams.set("X-Amz-Algorithm","AWS4-HMAC-SHA256"),v.searchParams.set("X-Amz-Content-Sha256",p),v.searchParams.set("X-Amz-Credential",`${e}/${b}`),v.searchParams.set("X-Amz-Date",f),v.searchParams.set("X-Amz-Expires",a),v.searchParams.set("X-Amz-Security-Token",s),v.searchParams.set("X-Amz-SignedHeaders","host"),c&&v.searchParams.set("partNumber",c),l&&v.searchParams.set("uploadId",l),v.searchParams.set("x-id",c&&l?"UploadPart":"PutObject");const T=Aa({CanonicalUri:h,CanonicalQueryString:v.search.slice(1),SignedHeaders:{host:u},HashedPayload:p}),R=hs(await Ca(T)),E=["AWS4-HMAC-SHA256",f,b,R].join(`
`),x=await _t(`AWS4${t}`,_),U=await _t(x,n),F=await _t(U,d),O=await _t(F,"aws4_request"),j=hs(await _t(O,E));return v.searchParams.set("X-Amz-Signature",j),v}function P(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var xa=0;function Y(r){return"__private_"+xa+++"_"+r}function ka(r){const e=new URL(r);return e.search="",e.hash="",e.href}var bt=Y("abortMultipartUpload"),B=Y("cache"),wt=Y("createMultipartUpload"),St=Y("fetchSignature"),xt=Y("getUploadParameters"),Pt=Y("listParts"),Le=Y("previousRetryDelay"),He=Y("requests"),ke=Y("retryDelays"),Me=Y("sendCompletionRequest"),je=Y("setS3MultipartState"),We=Y("uploadPartBytes"),D=Y("getFile"),Pr=Y("shouldRetry"),Tt=Y("nonMultipartUpload");class Ma{constructor(e,t,s,i){Object.defineProperty(this,Tt,{value:Na}),Object.defineProperty(this,Pr,{value:ja}),Object.defineProperty(this,bt,{writable:!0,value:void 0}),Object.defineProperty(this,B,{writable:!0,value:new WeakMap}),Object.defineProperty(this,wt,{writable:!0,value:void 0}),Object.defineProperty(this,St,{writable:!0,value:void 0}),Object.defineProperty(this,xt,{writable:!0,value:void 0}),Object.defineProperty(this,Pt,{writable:!0,value:void 0}),Object.defineProperty(this,Le,{writable:!0,value:void 0}),Object.defineProperty(this,He,{writable:!0,value:void 0}),Object.defineProperty(this,ke,{writable:!0,value:void 0}),Object.defineProperty(this,Me,{writable:!0,value:void 0}),Object.defineProperty(this,je,{writable:!0,value:void 0}),Object.defineProperty(this,We,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:void 0}),P(this,He)[He]=e,P(this,je)[je]=s,P(this,D)[D]=i,this.setOptions(t)}setOptions(e){const t=P(this,He)[He];if("abortMultipartUpload"in e&&(P(this,bt)[bt]=t.wrapPromiseFunction(e.abortMultipartUpload,{priority:1})),"createMultipartUpload"in e&&(P(this,wt)[wt]=t.wrapPromiseFunction(e.createMultipartUpload,{priority:-1})),"signPart"in e&&(P(this,St)[St]=t.wrapPromiseFunction(e.signPart)),"listParts"in e&&(P(this,Pt)[Pt]=t.wrapPromiseFunction(e.listParts)),"completeMultipartUpload"in e&&(P(this,Me)[Me]=t.wrapPromiseFunction(e.completeMultipartUpload,{priority:1})),"retryDelays"in e){var s;P(this,ke)[ke]=(s=e.retryDelays)!=null?s:[]}"uploadPartBytes"in e&&(P(this,We)[We]=t.wrapPromiseFunction(e.uploadPartBytes,{priority:1/0})),"getUploadParameters"in e&&(P(this,xt)[xt]=t.wrapPromiseFunction(e.getUploadParameters))}async getUploadId(e,t){let s;for(;(s=P(this,B)[B].get(e.data))!=null;)try{return await s}catch{}const i=P(this,wt)[wt](P(this,D)[D](e),t),o=()=>{i.abort(t.reason),P(this,B)[B].delete(e.data)};return t.addEventListener("abort",o,{once:!0}),P(this,B)[B].set(e.data,i),i.then(async n=>{t.removeEventListener("abort",o),P(this,je)[je](e,n),P(this,B)[B].set(e.data,n)},()=>{t.removeEventListener("abort",o),P(this,B)[B].delete(e.data)}),i}async abortFileUpload(e){const t=P(this,B)[B].get(e.data);if(t==null)return;P(this,B)[B].delete(e.data),P(this,je)[je](e,Object.create(null));let s;try{s=await t}catch{return}await P(this,bt)[bt](P(this,D)[D](e),s)}async uploadFile(e,t,s){if(H(s),t.length===1&&!t[0].shouldUseMultipart)return P(this,Tt)[Tt](e,t[0],s);const{uploadId:i,key:o}=await this.getUploadId(e,s);H(s);try{const n=await Promise.all(t.map((a,l)=>this.uploadChunk(e,l+1,a,s)));return H(s),await P(this,Me)[Me](P(this,D)[D](e),{key:o,uploadId:i,parts:n,signal:s},s).abortOn(s)}catch(n){throw(n==null?void 0:n.cause)!==Vt&&(n==null?void 0:n.name)!=="AbortError"&&this.abortFileUpload(e),n}}restoreUploadFile(e,t){P(this,B)[B].set(e.data,t)}async resumeUploadFile(e,t,s){if(H(s),t.length===1&&t[0]!=null&&!t[0].shouldUseMultipart)return P(this,Tt)[Tt](e,t[0],s);const{uploadId:i,key:o}=await this.getUploadId(e,s);H(s);const n=await P(this,Pt)[Pt](P(this,D)[D](e),{uploadId:i,key:o,signal:s},s).abortOn(s);H(s);const a=await Promise.all(t.map((l,c)=>{const d=c+1,u=n.find(h=>{let{PartNumber:p}=h;return p===d});return u==null?this.uploadChunk(e,d,l,s):(l==null||l.setAsUploaded==null||l.setAsUploaded(),{PartNumber:d,ETag:u.ETag})}));return H(s),P(this,Me)[Me](P(this,D)[D](e),{key:o,uploadId:i,parts:a,signal:s},s).abortOn(s)}async uploadChunk(e,t,s,i){H(i);const{uploadId:o,key:n}=await this.getUploadId(e,i),a=P(this,ke)[ke].values(),l=P(this,ke)[ke].values(),c=()=>{const d=a.next();return d==null||d.done?null:d.value};for(;;){H(i);const d=s.getData(),{onProgress:u,onComplete:h}=s;let p;try{p=await P(this,St)[St](P(this,D)[D](e),{uploadId:o,key:n,partNumber:t,body:d,signal:i}).abortOn(i)}catch(f){const _=c();if(_==null||i.aborted)throw f;await new Promise(b=>setTimeout(b,_));continue}H(i);try{return{PartNumber:t,...await P(this,We)[We]({signature:p,body:d,size:d.size,onProgress:u,onComplete:h,signal:i}).abortOn(i)}}catch(f){if(!await P(this,Pr)[Pr](f,l))throw f}}}}async function ja(r,e){var t;const s=P(this,He)[He],i=r==null||(t=r.source)==null?void 0:t.status;if(i==null)return!1;if(i===403&&r.message==="Request has expired"){if(!s.isPaused){if(s.limit===1||P(this,Le)[Le]==null){const o=e.next();if(o==null||o.done)return!1;P(this,Le)[Le]=o.value}s.rateLimit(0),await new Promise(o=>setTimeout(o,P(this,Le)[Le]))}}else if(i===429){if(!s.isPaused){const o=e.next();if(o==null||o.done)return!1;s.rateLimit(o.value)}}else{if(i>400&&i<500&&i!==409)return!1;if(typeof navigator<"u"&&navigator.onLine===!1)s.isPaused||(s.pause(),window.addEventListener("online",()=>{s.resume()},{once:!0}));else{const o=e.next();if(o==null||o.done)return!1;await new Promise(n=>setTimeout(n,o.value))}}return!0}async function Na(r,e,t){const{method:s="POST",url:i,fields:o,headers:n}=await P(this,xt)[xt](P(this,D)[D](r),{signal:t}).abortOn(t);let a;const l=e.getData();if(s.toUpperCase()==="POST"){const h=new FormData;Object.entries(o).forEach(p=>{let[f,_]=p;return h.set(f,_)}),h.set("file",l),a=h}else a=l;const{onProgress:c,onComplete:d}=e,u=await P(this,We)[We]({signature:{url:i,headers:n,method:s},body:a,size:l.size,onProgress:c,onComplete:d,signal:t}).abortOn(t);return"location"in u?u:{location:ka(i),...u}}function w(r,e){if(!{}.hasOwnProperty.call(r,e))throw new TypeError("attempted to use private field on non-instance");return r}var La=0;function Z(r){return"__private_"+La+++"_"+r}const Ia={version:"4.1.0"};function Qe(r){if(r!=null&&r.error){const e=new Error(r.message);throw Object.assign(e,r.error),e}return r}function Zs(r){const e=r.Expiration;if(e){const t=Math.floor((new Date(e)-Date.now())/1e3);if(t>9)return t}}function fs(r){let{meta:e,allowedMetaFields:t,querify:s=!1}=r;const i=t??Object.keys(e);return e?Object.fromEntries(i.filter(o=>e[o]!=null).map(o=>{const n=s?`metadata[${o}]`:o,a=String(e[o]);return[n,a]})):{}}const Ba={allowedMetaFields:!0,limit:6,getTemporarySecurityCredentials:!1,shouldUseMultipart:r=>r.size>>10>>10>100,retryDelays:[0,1e3,3e3,5e3]};var Ge=Z("companionCommunicationQueue"),A=Z("client"),Ft=Z("setClient"),K=Z("assertHost"),z=Z("cachedTemporaryCredentials"),Tr=Z("getTemporarySecurityCredentials"),Fr=Z("setS3MultipartState"),Ve=Z("getFile"),Ur=Z("uploadLocalFile"),Er=Z("getCompanionClientArgs"),Ut=Z("upload"),Ke=Z("setCompanionHeaders"),be=Z("setResumableUploadsCapability"),Et=Z("resetResumableCapability");class ir extends js{constructor(e,t){var s;super(e,{...Ba,uploadPartBytes:ir.uploadPartBytes,createMultipartUpload:null,listParts:null,abortMultipartUpload:null,completeMultipartUpload:null,signPart:null,getUploadParameters:null,...t}),Object.defineProperty(this,Er,{value:Wa}),Object.defineProperty(this,Ur,{value:Ha}),Object.defineProperty(this,Tr,{value:qa}),Object.defineProperty(this,K,{value:Da}),Object.defineProperty(this,Ft,{value:za}),Object.defineProperty(this,Ge,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,z,{writable:!0,value:void 0}),Object.defineProperty(this,Fr,{writable:!0,value:(o,n)=>{let{key:a,uploadId:l}=n;const c=this.uppy.getFile(o.id);c!=null&&this.uppy.setFileState(o.id,{s3Multipart:{...c.s3Multipart,key:a,uploadId:l}})}}),Object.defineProperty(this,Ve,{writable:!0,value:o=>this.uppy.getFile(o.id)||o}),Object.defineProperty(this,Ut,{writable:!0,value:async o=>{if(o.length===0)return;const n=this.uppy.getFilesByIds(o),a=_a(n),l=ba(a);this.uppy.emit("upload-start",l);const c=a.map(u=>{if(u.isRemote){const h=()=>this.requests;w(this,be)[be](!1);const p=new AbortController,f=b=>{b.id===u.id&&p.abort()};this.uppy.on("file-removed",f);const _=this.uppy.getRequestClientForFile(u).uploadRemoteFile(u,w(this,Er)[Er](u),{signal:p.signal,getQueue:h});return this.requests.wrapSyncFunction(()=>{this.uppy.off("file-removed",f)},{priority:-1})(),_}return w(this,Ur)[Ur](u)}),d=await Promise.all(c);return w(this,be)[be](!0),d}}),Object.defineProperty(this,Ke,{writable:!0,value:()=>{var o;(o=w(this,A)[A])==null||o.setCompanionHeaders(this.opts.headers)}}),Object.defineProperty(this,be,{writable:!0,value:o=>{const{capabilities:n}=this.uppy.getState();this.uppy.setState({capabilities:{...n,resumableUploads:o}})}}),Object.defineProperty(this,Et,{writable:!0,value:()=>{w(this,be)[be](!0)}}),this.type="uploader",this.id=this.opts.id||"AwsS3Multipart",w(this,Ft)[Ft](t);const i={createMultipartUpload:this.createMultipartUpload,listParts:this.listParts,abortMultipartUpload:this.abortMultipartUpload,completeMultipartUpload:this.completeMultipartUpload,signPart:t!=null&&t.getTemporarySecurityCredentials?this.createSignedURL:this.signPart,getUploadParameters:t!=null&&t.getTemporarySecurityCredentials?this.createSignedURL:this.getUploadParameters};for(const o of Object.keys(i))this.opts[o]==null&&(this.opts[o]=i[o].bind(this));this.requests=(s=this.opts.rateLimitedQueue)!=null?s:new ha(this.opts.limit),w(this,Ge)[Ge]=new Ma(this.requests,this.opts,w(this,Fr)[Fr],w(this,Ve)[Ve]),this.uploaders=Object.create(null),this.uploaderEvents=Object.create(null)}[Symbol.for("uppy test: getClient")](){return w(this,A)[A]}setOptions(e){w(this,Ge)[Ge].setOptions(e),super.setOptions(e),w(this,Ft)[Ft](e)}resetUploaderReferences(e,t){this.uploaders[e]&&(this.uploaders[e].abort({really:(t==null?void 0:t.abort)||!1}),this.uploaders[e]=null),this.uploaderEvents[e]&&(this.uploaderEvents[e].remove(),this.uploaderEvents[e]=null)}createMultipartUpload(e,t){w(this,K)[K]("createMultipartUpload"),H(t);const s=ds(this.opts.allowedMetaFields,e.meta),i=fs({meta:e.meta,allowedMetaFields:s});return w(this,A)[A].post("s3/multipart",{filename:e.name,type:e.type,metadata:i},{signal:t}).then(Qe)}listParts(e,t,s){var i;let{key:o,uploadId:n,signal:a}=t;(i=a)!=null||(a=s),w(this,K)[K]("listParts"),H(a);const l=encodeURIComponent(o);return w(this,A)[A].get(`s3/multipart/${encodeURIComponent(n)}?key=${l}`,{signal:a}).then(Qe)}completeMultipartUpload(e,t,s){var i;let{key:o,uploadId:n,parts:a,signal:l}=t;(i=l)!=null||(l=s),w(this,K)[K]("completeMultipartUpload"),H(l);const c=encodeURIComponent(o),d=encodeURIComponent(n);return w(this,A)[A].post(`s3/multipart/${d}/complete?key=${c}`,{parts:a.map(u=>{let{ETag:h,PartNumber:p}=u;return{ETag:h,PartNumber:p}})},{signal:l}).then(Qe)}async createSignedURL(e,t){const s=await w(this,Tr)[Tr](t),i=Zs(s.credentials)||604800,{uploadId:o,key:n,partNumber:a}=t;return{method:"PUT",expires:i,fields:{},url:`${await Ra({accountKey:s.credentials.AccessKeyId,accountSecret:s.credentials.SecretAccessKey,sessionToken:s.credentials.SessionToken,expires:i,bucketName:s.bucket,Region:s.region,Key:n??`${crypto.randomUUID()}-${e.name}`,uploadId:o,partNumber:a})}`,headers:{"Content-Type":e.type}}}signPart(e,t){let{uploadId:s,key:i,partNumber:o,signal:n}=t;if(w(this,K)[K]("signPart"),H(n),s==null||i==null||o==null)throw new Error("Cannot sign without a key, an uploadId, and a partNumber");const a=encodeURIComponent(i);return w(this,A)[A].get(`s3/multipart/${encodeURIComponent(s)}/${o}?key=${a}`,{signal:n}).then(Qe)}abortMultipartUpload(e,t){let{key:s,uploadId:i,signal:o}=t;w(this,K)[K]("abortMultipartUpload");const n=encodeURIComponent(s),a=encodeURIComponent(i);return w(this,A)[A].delete(`s3/multipart/${a}?key=${n}`,void 0,{signal:o}).then(Qe)}getUploadParameters(e,t){w(this,K)[K]("getUploadParameters");const{meta:s}=e,{type:i,name:o}=s,n=ds(this.opts.allowedMetaFields,e.meta),a=fs({meta:s,allowedMetaFields:n,querify:!0}),l=new URLSearchParams({filename:o,type:i,...a});return w(this,A)[A].get(`s3/params?${l}`,t)}static async uploadPartBytes(e){let{signature:{url:t,expires:s,headers:i,method:o="PUT"},body:n,size:a=n.size,onProgress:l,onComplete:c,signal:d}=e;if(H(d),t==null)throw new Error("Cannot upload to an undefined URL");return new Promise((u,h)=>{const p=new XMLHttpRequest;p.open(o,t,!0),i&&Object.keys(i).forEach(b=>{p.setRequestHeader(b,i[b])}),p.responseType="text",typeof s=="number"&&(p.timeout=s*1e3);function f(){p.abort()}function _(){d==null||d.removeEventListener("abort",f)}d==null||d.addEventListener("abort",f),p.upload.addEventListener("progress",b=>{l(b)}),p.addEventListener("abort",()=>{_(),h(Qs())}),p.addEventListener("timeout",()=>{_();const b=new Error("Request has expired");b.source={status:403},h(b)}),p.addEventListener("load",()=>{if(_(),p.status===403&&p.responseText.includes("<Message>Request has expired</Message>")){const E=new Error("Request has expired");E.source=p,h(E);return}if(p.status<200||p.status>=300){const E=new Error("Non 2xx");E.source=p,h(E);return}l==null||l({loaded:a,lengthComputable:!0});const b=p.getAllResponseHeaders().trim().split(/[\r\n]+/),v={__proto__:null};for(const E of b){const x=E.split(": "),U=x.shift(),F=x.join(": ");v[U]=F}const{etag:T,location:R}=v;if(o.toUpperCase()==="POST"&&R===null&&console.warn("AwsS3/Multipart: Could not read the Location header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."),T===null){h(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. See https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."));return}c==null||c(T),u({...v,ETag:T})}),p.addEventListener("error",b=>{_();const v=new Error("Unknown error");v.source=b.target,h(v)}),p.send(n)})}install(){w(this,be)[be](!0),this.uppy.addPreProcessor(w(this,Ke)[Ke]),this.uppy.addUploader(w(this,Ut)[Ut]),this.uppy.on("cancel-all",w(this,Et)[Et])}uninstall(){this.uppy.removePreProcessor(w(this,Ke)[Ke]),this.uppy.removeUploader(w(this,Ut)[Ut]),this.uppy.off("cancel-all",w(this,Et)[Et])}}function za(r){r==null||!("endpoint"in r||"companionUrl"in r||"headers"in r||"companionHeaders"in r||"cookiesRule"in r||"companionCookiesRule"in r)||("companionUrl"in r&&!("endpoint"in r)&&this.uppy.log("`companionUrl` option has been removed in @uppy/aws-s3, use `endpoint` instead.","warning"),"companionHeaders"in r&&!("headers"in r)&&this.uppy.log("`companionHeaders` option has been removed in @uppy/aws-s3, use `headers` instead.","warning"),"companionCookiesRule"in r&&!("cookiesRule"in r)&&this.uppy.log("`companionCookiesRule` option has been removed in @uppy/aws-s3, use `cookiesRule` instead.","warning"),"endpoint"in r?w(this,A)[A]=new Js(this.uppy,{pluginId:this.id,provider:"AWS",companionUrl:this.opts.endpoint,companionHeaders:this.opts.headers,companionCookiesRule:this.opts.cookiesRule}):("headers"in r&&w(this,Ke)[Ke](),"cookiesRule"in r&&(w(this,A)[A].opts.companionCookiesRule=r.cookiesRule)))}function Da(r){if(!w(this,A)[A])throw new Error(`Expected a \`endpoint\` option containing a URL, or if you are not using Companion, a custom \`${r}\` implementation.`)}async function qa(r){if(H(r==null?void 0:r.signal),w(this,z)[z]==null){const{getTemporarySecurityCredentials:e}=this.opts;e===!0?(w(this,K)[K]("getTemporarySecurityCredentials"),w(this,z)[z]=w(this,A)[A].get("s3/sts",r).then(Qe)):w(this,z)[z]=e(r),w(this,z)[z]=await w(this,z)[z],setTimeout(()=>{w(this,z)[z]=null},(Zs(w(this,z)[z].credentials)||0)*500)}return w(this,z)[z]}function Ha(r){var e=this;return new Promise((t,s)=>{const i=(c,d)=>{var u;const h=this.uppy.getFile(r.id);this.uppy.emit("upload-progress",h,{uploadStarted:(u=h.progress.uploadStarted)!=null?u:0,bytesUploaded:c,bytesTotal:d})},o=c=>{this.uppy.log(c),this.uppy.emit("upload-error",r,c),this.resetUploaderReferences(r.id),s(c)},n=c=>{const d={body:{...c},status:200,uploadURL:c.location};this.resetUploaderReferences(r.id),this.uppy.emit("upload-success",w(this,Ve)[Ve](r),d),c.location&&this.uppy.log(`Download ${r.name} from ${c.location}`),t()},a=new Ta(r.data,{companionComm:w(this,Ge)[Ge],log:function(){return e.uppy.log(...arguments)},getChunkSize:this.opts.getChunkSize?this.opts.getChunkSize.bind(this):void 0,onProgress:i,onError:o,onSuccess:n,onPartComplete:c=>{this.uppy.emit("s3-multipart:part-uploaded",w(this,Ve)[Ve](r),c)},file:r,shouldUseMultipart:this.opts.shouldUseMultipart,...r.s3Multipart});this.uploaders[r.id]=a;const l=new ca(this.uppy);this.uploaderEvents[r.id]=l,l.onFileRemove(r.id,c=>{a.abort(),this.resetUploaderReferences(r.id,{abort:!0}),t(`upload ${c} was removed`)}),l.onCancelAll(r.id,()=>{a.abort(),this.resetUploaderReferences(r.id,{abort:!0}),t(`upload ${r.id} was canceled`)}),l.onFilePause(r.id,c=>{c?a.pause():a.start()}),l.onPauseAll(r.id,()=>{a.pause()}),l.onResumeAll(r.id,()=>{a.start()}),a.start()})}function Wa(r){var e;return{...(e=r.remote)==null?void 0:e.body,protocol:"s3-multipart",size:r.data.size,metadata:r.meta}}ir.VERSION=Ia.version;function Ga(r,e,t,s,i,o,n,a){var l=typeof r=="function"?r.options:r;e&&(l.render=e,l.staticRenderFns=t,l._compiled=!0),s&&(l.functional=!0),o&&(l._scopeId="data-v-"+o);var c;if(n?(c=function(h){h=h||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!h&&typeof __VUE_SSR_CONTEXT__<"u"&&(h=__VUE_SSR_CONTEXT__),i&&i.call(this,h),h&&h._registeredComponents&&h._registeredComponents.add(n)},l._ssrRegister=c):i&&(c=a?function(){i.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(p,f){return c.call(f),d(p,f)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:r,options:l}}const Ka={mixins:[Fieldtype],data(){return{}},mounted(){this.initUppy()},computed:{acceptMimeTypes(){return null},canUpload(){return this.config.allow_uploads&&(this.can("configure asset containers")||this.can("upload "+this.container+" assets"))}},methods:{initUppy(){if(!this.canUpload)return;const r=new Vo({autoProceed:!0});r.use(rr,{target:this.$refs.dragDrop}),r.use(Ws,{target:this.$refs.statusBar}),r.use(ir,{shouldUseMultipart:!0,createMultipartUpload:async(e,t)=>{t==null||t.throwIfAborted();const s=cp_url("large-assets/api/upload/create");return(await this.$axios.post(s,{container:this.config.container,key:e.name})).data},signPart:async(e,{uploadId:t,key:s,partNumber:i,signal:o})=>{o==null||o.throwIfAborted();const n=cp_url("large-assets/api/upload/sign-part");return(await this.$axios.post(n,{container:this.config.container,key:s,uploadId:t,partNumber:i})).data},completeMultipartUpload:async(e,{key:t,uploadId:s,parts:i},o)=>{o==null||o.throwIfAborted();const n=cp_url("large-assets/api/upload/complete");return(await this.$axios.post(n,{container:this.config.container,key:t,uploadId:s,parts:i})).data},listParts:async(e,{key:t,uploadId:s},i)=>{i==null||i.throwIfAborted();const o=cp_url("large-assets/api/upload/list-parts");return(await this.$axios.post(o,{container:this.config.container,key:t,uploadId:s})).data},abortMultipartUpload:async(e,{key:t,uploadId:s})=>{const i=cp_url("large-assets/api/upload/abort");await this.$axios.post(i,{container:this.config.container,key:t,uploadId:s})}}),r.on("complete",e=>{console.log("Upload complete! We’ve uploaded these files:",e.successful)}),r.on("upload-success",(e,t)=>{console.log("Upload success! We’ve uploaded this file:",e.meta.name)})}}};var Xa=function(){var e=this,t=e._self._c;return t("div",[e.canUpload?t("div",[t("div",{ref:"statusBar"}),t("div",{ref:"dragDrop"})]):e._e()])},Va=[],Ja=Ga(Ka,Xa,Va,!1,null,null,null,null);const Ya=Ja.exports;Statamic.booting(()=>{Statamic.component("large_assets-fieldtype",Ya)});
